<!DOCTYPE html>
<html lang="ko" class="no-js">
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
    

    
    

    
    

    
    

    <title>k8s 구성요소 - 볼륨과 스테이트풀셋 | Hoonology</title>
    <meta name="description" content="파드 그 자체는 Stateless, 파드의 교체와 배치를 담당하는 것이 '디플로이먼트', 레플리카셋을 통해 파드를 scale out하며, 이때 만들어지는 파드들은 상호 대체 가능합니다.">
    
        <meta name="keywords" content="kubernetes, k8s, pod, workload, 워크로드">
    

    <!-- Social: Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="k8s 구성요소 - 볼륨과 스테이트풀셋 | Hoonology">
    <meta name="twitter:description" content="파드 그 자체는 Stateless, 파드의 교체와 배치를 담당하는 것이 '디플로이먼트', 레플리카셋을 통해 파드를 scale out하며, 이때 만들어지는 파드들은 상호 대체 가능합니다.">

    
        <meta property="twitter:image" content="https://res.cloudinary.com/dvqcvocet/image/upload/v1684335849/%E1%84%8F%E1%85%AE%E1%84%87%E1%85%A5%E1%84%8C%E1%85%B5%E1%86%AB%E1%84%89%E1%85%B3_yoqeyy.png">
    
    
    

    <!-- Social: Facebook / Open Graph -->
    <meta property="og:url" content="http://localhost:4000/k8s-volume/">
    <meta property="og:title" content="k8s 구성요소 - 볼륨과 스테이트풀셋 | Hoonology">
    <meta property="og:image" content="https://res.cloudinary.com/dvqcvocet/image/upload/v1684335849/%E1%84%8F%E1%85%AE%E1%84%87%E1%85%A5%E1%84%8C%E1%85%B5%E1%86%AB%E1%84%89%E1%85%B3_yoqeyy.png">
    <meta property="og:description" content="파드 그 자체는 Stateless, 파드의 교체와 배치를 담당하는 것이 '디플로이먼트', 레플리카셋을 통해 파드를 scale out하며, 이때 만들어지는 파드들은 상호 대체 가능합니다.">
    <meta property="og:site_name" content="Hoonology | Welcome to Hoony's Blog !">

    <!-- Favicon -->
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    
    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" href="/assets/img/icons/apple-touch-icon.png" />
    <link rel="apple-touch-icon" sizes="57x57" href="/assets/img/icons/apple-touch-icon-57x57.png" />
    <link rel="apple-touch-icon" sizes="72x72" href="/assets/img/icons/apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon" sizes="114x114" href="/assets/img/icons/apple-touch-icon-114x114.png" />
    <link rel="apple-touch-icon" sizes="144x144" href="/assets/img/icons/apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon" sizes="60x60" href="/assets/img/icons/apple-touch-icon-60x60.png" />
    <link rel="apple-touch-icon" sizes="120x120" href="/assets/img/icons/apple-touch-icon-120x120.png" />
    <link rel="apple-touch-icon" sizes="76x76" href="/assets/img/icons/apple-touch-icon-76x76.png" />
    <link rel="apple-touch-icon" sizes="152x152" href="/assets/img/icons/apple-touch-icon-152x152.png" />

    <!-- Windows 8 Tile Icons -->
    <meta name="application-name" content="Hoonology">
    <meta name="msapplication-TileColor" content="#141414">
    <meta name="msapplication-square70x70logo" content="smalltile.png" />
    <meta name="msapplication-square150x150logo" content="mediumtile.png" />
    <meta name="msapplication-wide310x150logo" content="widetile.png" />
    <meta name="msapplication-square310x310logo" content="largetile.png" />
    
    <!-- Android Lolipop Theme Color -->
    <meta name="theme-color" content="#141414">

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Titillium+Web:300,400,700" rel="stylesheet">

    <link rel="stylesheet" href="/assets/css/styles.css">
    <link rel="canonical" href="http://localhost:4000/k8s-volume/">
    <link rel="alternate" type="application/rss+xml" title="Hoonology | Welcome to Hoony's Blog !" href="http://localhost:4000/feed.xml" />

    <!-- Include extra styles -->
    

    <!-- JavaScript enabled/disabled -->
    <script>
        document.querySelector('html').classList.remove('no-js');
    </script>
</head>

    <body class="has-push-menu">
        





        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" display="none" version="1.1"><defs><symbol id="icon-menu" viewBox="0 0 1024 1024"><path class="path1" d="M128 213.333h768q17.667 0 30.167 12.5t12.5 30.167-12.5 30.167-30.167 12.5h-768q-17.667 0-30.167-12.5t-12.5-30.167 12.5-30.167 30.167-12.5zM128 725.333h768q17.667 0 30.167 12.5t12.5 30.167-12.5 30.167-30.167 12.5h-768q-17.667 0-30.167-12.5t-12.5-30.167 12.5-30.167 30.167-12.5zM128 469.333h768q17.667 0 30.167 12.5t12.5 30.167-12.5 30.167-30.167 12.5h-768q-17.667 0-30.167-12.5t-12.5-30.167 12.5-30.167 30.167-12.5z"/></symbol><symbol id="icon-search" viewBox="0 0 951 1024"><path class="path1" d="M658.286 475.429q0-105.714-75.143-180.857t-180.857-75.143-180.857 75.143-75.143 180.857 75.143 180.857 180.857 75.143 180.857-75.143 75.143-180.857zM950.857 950.857q0 29.714-21.714 51.429t-51.429 21.714q-30.857 0-51.429-21.714l-196-195.429q-102.286 70.857-228 70.857-81.714 0-156.286-31.714t-128.571-85.714-85.714-128.571-31.714-156.286 31.714-156.286 85.714-128.571 128.571-85.714 156.286-31.714 156.286 31.714 128.571 85.714 85.714 128.571 31.714 156.286q0 125.714-70.857 228l196 196q21.143 21.143 21.143 51.429z"/></symbol><symbol id="icon-close" viewBox="0 0 1000 1000"><path d="M969.8,870.3c27,27.7,27,71.8,0,99.1C955.7,983,937.9,990,920,990c-17.9,0-35.7-7-49.7-20.7L500,599L129.6,969.4C115.6,983,97.8,990,79.9,990s-35.7-7-49.7-20.7c-27-27.3-27-71.4,0-99.1L400.9,500L30.3,129.3c-27-27.3-27-71.4,0-99.1c27.3-27,71.8-27,99.4,0L500,400.9L870.4,30.2c27.7-27,71.8-27,99.4,0c27,27.7,27,71.8,0,99.1L599.1,500L969.8,870.3z"/></symbol><symbol id="icon-twitter" viewBox="0 0 951 1024"><path class="path1" d="M925.714 233.143q-38.286 56-92.571 95.429 0.571 8 0.571 24 0 74.286-21.714 148.286t-66 142-105.429 120.286-147.429 83.429-184.571 31.143q-154.857 0-283.429-82.857 20 2.286 44.571 2.286 128.571 0 229.143-78.857-60-1.143-107.429-36.857t-65.143-91.143q18.857 2.857 34.857 2.857 24.571 0 48.571-6.286-64-13.143-106-63.714t-42-117.429v-2.286q38.857 21.714 83.429 23.429-37.714-25.143-60-65.714t-22.286-88q0-50.286 25.143-93.143 69.143 85.143 168.286 136.286t212.286 56.857q-4.571-21.714-4.571-42.286 0-76.571 54-130.571t130.571-54q80 0 134.857 58.286 62.286-12 117.143-44.571-21.143 65.714-81.143 101.714 53.143-5.714 106.286-28.571z"/></symbol><symbol id="icon-facebook" viewBox="0 0 585 1024"><path class="path1" d="M548 6.857v150.857h-89.714q-49.143 0-66.286 20.571t-17.143 61.714v108h167.429l-22.286 169.143h-145.143v433.714h-174.857v-433.714h-145.714v-169.143h145.714v-124.571q0-106.286 59.429-164.857t158.286-58.571q84 0 130.286 6.857z"/></symbol><symbol id="icon-clock" viewBox="0 0 1000 1000"><path d="M500,10C229.8,10,10,229.8,10,500c0,270.2,219.8,490,490,490c270.2,0,490-219.8,490-490C990,229.8,770.2,10,500,10z M500,910.2c-226.2,0-410.2-184-410.2-410.2c0-226.2,184-410.2,410.2-410.2c226.2,0,410.2,184,410.2,410.2C910.2,726.1,726.2,910.2,500,910.2z M753.1,374c8.2,11.9,5.2,28.1-6.6,36.3L509.9,573.7c-4.4,3.1-9.6,4.6-14.8,4.6c-4.1,0-8.3-1-12.1-3c-8.6-4.5-14-13.4-14-23.1V202.5c0-14.4,11.7-26.1,26.1-26.1c14.4,0,26.1,11.7,26.1,26.1v300l195.6-135.1C728.7,359.2,744.9,362.1,753.1,374z"/></symbol><symbol id="icon-calendar" viewBox="0 0 1000 1000"><path d="M920,500v420H80V500H920 M990,430H10v490c0,38.7,31.3,70,70,70h840c38.7,0,70-31.3,70-70V430L990,430z"/><path d="M850,80v105c0,57.9-47.2,105-105,105c-58,0-105-47.1-105-105V80H360v105c0,57.9-47.2,105-105,105c-58,0-105-47.1-105-105V80C72.8,80,10,142.7,10,220v140h980V220C990,142.7,927.2,80,850,80z"/><path d="M255,10c-19.3,0-35,15.8-35,35v140c0,19.2,15.7,35,35,35c19.3,0,35-15.8,35-35V45C290,25.8,274.3,10,255,10z"/><path d="M745,10c-19.3,0-35,15.8-35,35v140c0,19.2,15.7,35,35,35c19.3,0,35-15.8,35-35V45C780,25.8,764.3,10,745,10z"/></symbol><symbol id="icon-github" viewBox="0 0 12 14"><path d="M6 1q1.633 0 3.012 0.805t2.184 2.184 0.805 3.012q0 1.961-1.145 3.527t-2.957 2.168q-0.211 0.039-0.312-0.055t-0.102-0.234q0-0.023 0.004-0.598t0.004-1.051q0-0.758-0.406-1.109 0.445-0.047 0.801-0.141t0.734-0.305 0.633-0.52 0.414-0.82 0.16-1.176q0-0.93-0.617-1.609 0.289-0.711-0.062-1.594-0.219-0.070-0.633 0.086t-0.719 0.344l-0.297 0.187q-0.727-0.203-1.5-0.203t-1.5 0.203q-0.125-0.086-0.332-0.211t-0.652-0.301-0.664-0.105q-0.352 0.883-0.062 1.594-0.617 0.68-0.617 1.609 0 0.664 0.16 1.172t0.41 0.82 0.629 0.523 0.734 0.305 0.801 0.141q-0.305 0.281-0.383 0.805-0.164 0.078-0.352 0.117t-0.445 0.039-0.512-0.168-0.434-0.488q-0.148-0.25-0.379-0.406t-0.387-0.187l-0.156-0.023q-0.164 0-0.227 0.035t-0.039 0.090 0.070 0.109 0.102 0.094l0.055 0.039q0.172 0.078 0.34 0.297t0.246 0.398l0.078 0.18q0.102 0.297 0.344 0.48t0.523 0.234 0.543 0.055 0.434-0.027l0.18-0.031q0 0.297 0.004 0.691t0.004 0.426q0 0.141-0.102 0.234t-0.312 0.055q-1.812-0.602-2.957-2.168t-1.145-3.527q0-1.633 0.805-3.012t2.184-2.184 3.012-0.805zM2.273 9.617q0.023-0.055-0.055-0.094-0.078-0.023-0.102 0.016-0.023 0.055 0.055 0.094 0.070 0.047 0.102-0.016zM2.516 9.883q0.055-0.039-0.016-0.125-0.078-0.070-0.125-0.023-0.055 0.039 0.016 0.125 0.078 0.078 0.125 0.023zM2.75 10.234q0.070-0.055 0-0.148-0.062-0.102-0.133-0.047-0.070 0.039 0 0.141t0.133 0.055zM3.078 10.562q0.062-0.062-0.031-0.148-0.094-0.094-0.156-0.023-0.070 0.062 0.031 0.148 0.094 0.094 0.156 0.023zM3.523 10.758q0.023-0.086-0.102-0.125-0.117-0.031-0.148 0.055t0.102 0.117q0.117 0.047 0.148-0.047zM4.016 10.797q0-0.102-0.133-0.086-0.125 0-0.125 0.086 0 0.102 0.133 0.086 0.125 0 0.125-0.086zM4.469 10.719q-0.016-0.086-0.141-0.070-0.125 0.023-0.109 0.117t0.141 0.062 0.109-0.109z"></path></symbol><symbol id="icon-medium" viewBox="0 0 1000 1000"><path d="M336.5,240.2v641.5c0,9.1-2.3,16.9-6.8,23.2s-11.2,9.6-20,9.6c-6.2,0-12.2-1.5-18-4.4L37.3,782.7c-7.7-3.6-14.1-9.8-19.4-18.3S10,747.4,10,739V115.5c0-7.3,1.8-13.5,5.5-18.6c3.6-5.1,8.9-7.7,15.9-7.7c5.1,0,13.1,2.7,24.1,8.2l279.5,140C335.9,238.6,336.5,239.5,336.5,240.2L336.5,240.2z M371.5,295.5l292,473.6l-292-145.5V295.5z M990,305.3v576.4c0,9.1-2.6,16.5-7.7,22.1c-5.1,5.7-12,8.5-20.8,8.5s-17.3-2.4-25.7-7.1L694.7,784.9L990,305.3z M988.4,239.7c0,1.1-46.8,77.6-140.3,229.4C754.6,621,699.8,709.8,683.8,735.7L470.5,389l177.2-288.2c6.2-10.2,15.7-15.3,28.4-15.3c5.1,0,9.8,1.1,14.2,3.3l295.9,147.7C987.6,237.1,988.4,238.2,988.4,239.7L988.4,239.7z"/></symbol><symbol id="icon-instagram" viewBox="0 0 489.84 489.84"><path d="M249.62,50.46c65.4,0,73.14.25,99,1.43C372.47,53,385.44,57,394.07,60.32a75.88,75.88,0,0,1,28.16,18.32,75.88,75.88,0,0,1,18.32,28.16c3.35,8.63,7.34,21.6,8.43,45.48,1.18,25.83,1.43,33.57,1.43,99s-0.25,73.14-1.43,99c-1.09,23.88-5.08,36.85-8.43,45.48a81.11,81.11,0,0,1-46.48,46.48c-8.63,3.35-21.6,7.34-45.48,8.43-25.82,1.18-33.57,1.43-99,1.43s-73.15-.25-99-1.43c-23.88-1.09-36.85-5.08-45.48-8.43A75.88,75.88,0,0,1,77,423.86,75.88,75.88,0,0,1,58.69,395.7c-3.35-8.63-7.34-21.6-8.43-45.48-1.18-25.83-1.43-33.57-1.43-99s0.25-73.14,1.43-99c1.09-23.88,5.08-36.85,8.43-45.48A75.88,75.88,0,0,1,77,78.64a75.88,75.88,0,0,1,28.16-18.32c8.63-3.35,21.6-7.34,45.48-8.43,25.83-1.18,33.57-1.43,99-1.43m0-44.13c-66.52,0-74.86.28-101,1.47s-43.87,5.33-59.45,11.38A120.06,120.06,0,0,0,45.81,47.44,120.06,120.06,0,0,0,17.56,90.82C11.5,106.4,7.36,124.2,6.17,150.27s-1.47,34.46-1.47,101,0.28,74.86,1.47,101,5.33,43.87,11.38,59.45a120.06,120.06,0,0,0,28.25,43.38,120.06,120.06,0,0,0,43.38,28.25c15.58,6.05,33.38,10.19,59.45,11.38s34.46,1.47,101,1.47,74.86-.28,101-1.47,43.87-5.33,59.45-11.38a125.24,125.24,0,0,0,71.63-71.63c6.05-15.58,10.19-33.38,11.38-59.45s1.47-34.46,1.47-101-0.28-74.86-1.47-101-5.33-43.87-11.38-59.45a120.06,120.06,0,0,0-28.25-43.38,120.06,120.06,0,0,0-43.38-28.25C394.47,13.13,376.67,9,350.6,7.8s-34.46-1.47-101-1.47h0Z" transform="translate(-4.7 -6.33)" /><path d="M249.62,125.48A125.77,125.77,0,1,0,375.39,251.25,125.77,125.77,0,0,0,249.62,125.48Zm0,207.41a81.64,81.64,0,1,1,81.64-81.64A81.64,81.64,0,0,1,249.62,332.89Z" transform="translate(-4.7 -6.33)"/><circle cx="375.66" cy="114.18" r="29.39" /></symbol><symbol id="icon-linkedin" viewBox="0 0 12 14"><path d="M2.727 4.883v7.742h-2.578v-7.742h2.578zM2.891 2.492q0.008 0.57-0.395 0.953t-1.059 0.383h-0.016q-0.641 0-1.031-0.383t-0.391-0.953q0-0.578 0.402-0.957t1.051-0.379 1.039 0.379 0.398 0.957zM12 8.187v4.437h-2.57v-4.141q0-0.82-0.316-1.285t-0.988-0.465q-0.492 0-0.824 0.27t-0.496 0.668q-0.086 0.234-0.086 0.633v4.32h-2.57q0.016-3.117 0.016-5.055t-0.008-2.313l-0.008-0.375h2.57v1.125h-0.016q0.156-0.25 0.32-0.438t0.441-0.406 0.68-0.34 0.895-0.121q1.336 0 2.148 0.887t0.813 2.598z"></path></symbol><symbol id="icon-heart" viewBox="0 0 34 30"><path d="M17,29.7 L16.4,29.2 C3.5,18.7 0,15 0,9 C0,4 4,0 9,0 C13.1,0 15.4,2.3 17,4.1 C18.6,2.3 20.9,0 25,0 C30,0 34,4 34,9 C34,15 30.5,18.7 17.6,29.2 L17,29.7 Z M9,2 C5.1,2 2,5.1 2,9 C2,14.1 5.2,17.5 17,27.1 C28.8,17.5 32,14.1 32,9 C32,5.1 28.9,2 25,2 C21.5,2 19.6,4.1 18.1,5.8 L17,7.1 L15.9,5.8 C14.4,4.1 12.5,2 9,2 Z" id="Shape"></path></symbol><symbol id="icon-arrow-right" viewBox="0 0 25.452 25.452"><path d="M4.471,24.929v-2.004l12.409-9.788c0.122-0.101,0.195-0.251,0.195-0.411c0-0.156-0.073-0.31-0.195-0.409L4.471,2.526V0.522c0-0.2,0.115-0.384,0.293-0.469c0.18-0.087,0.396-0.066,0.552,0.061l15.47,12.202c0.123,0.1,0.195,0.253,0.195,0.409c0,0.16-0.072,0.311-0.195,0.411L5.316,25.34c-0.155,0.125-0.372,0.147-0.552,0.061C4.586,25.315,4.471,25.13,4.471,24.929z"/></symbol><symbol id="icon-star" viewBox="0 0 48 48"><path fill="currentColor" d="M44,24c0,11.045-8.955,20-20,20S4,35.045,4,24S12.955,4,24,4S44,12.955,44,24z"/><path fill="#ffffff" d="M24,11l3.898,7.898l8.703,1.301l-6.301,6.102l1.5,8.699L24,30.898L16.199,35l1.5-8.699l-6.301-6.102  l8.703-1.301L24,11z"/></symbol><symbol id="icon-read" viewBox="0 0 32 32"><path fill="currentColor" d="M29,4H3C1.343,4,0,5.343,0,7v18c0,1.657,1.343,3,3,3h10c0,0.552,0.448,1,1,1h4c0.552,0,1-0.448,1-1h10  c1.657,0,3-1.343,3-3V7C32,5.343,30.657,4,29,4z M29,5v20H18.708c-0.618,0-1.236,0.146-1.789,0.422l-0.419,0.21V5H29z M15.5,5  v20.632l-0.419-0.21C14.528,25.146,13.91,25,13.292,25H3V5H15.5z M31,25c0,1.103-0.897,2-2,2H18v1h-4v-1H3c-1.103,0-2-0.897-2-2V7  c0-0.737,0.405-1.375,1-1.722V25c0,0.552,0.448,1,1,1h10.292c0.466,0,0.925,0.108,1.342,0.317l0.919,0.46  c0.141,0.07,0.294,0.106,0.447,0.106c0.153,0,0.306-0.035,0.447-0.106l0.919-0.46C17.783,26.108,18.242,26,18.708,26H29  c0.552,0,1-0.448,1-1V5.278C30.595,5.625,31,6.263,31,7V25z M6,12.5C6,12.224,6.224,12,6.5,12h5c0.276,0,0.5,0.224,0.5,0.5  S11.776,13,11.5,13h-5C6.224,13,6,12.776,6,12.5z M6,14.5C6,14.224,6.224,14,6.5,14h5c0.276,0,0.5,0.224,0.5,0.5S11.776,15,11.5,15  h-5C6.224,15,6,14.776,6,14.5z M6,16.5C6,16.224,6.224,16,6.5,16h5c0.276,0,0.5,0.224,0.5,0.5S11.776,17,11.5,17h-5  C6.224,17,6,16.776,6,16.5z M20,12.5c0-0.276,0.224-0.5,0.5-0.5h5c0.276,0,0.5,0.224,0.5,0.5S25.776,13,25.5,13h-5  C20.224,13,20,12.776,20,12.5z M20,14.5c0-0.276,0.224-0.5,0.5-0.5h5c0.276,0,0.5,0.224,0.5,0.5S25.776,15,25.5,15h-5  C20.224,15,20,14.776,20,14.5z M20,16.5c0-0.276,0.224-0.5,0.5-0.5h5c0.276,0,0.5,0.224,0.5,0.5S25.776,17,25.5,17h-5  C20.224,17,20,16.776,20,16.5z"></path></symbol></defs></svg>

        <header class="bar-header">
    <a id="menu" role="button">
        <svg id="open" class="icon-menu"><use xlink:href="#icon-menu"></use></svg>
    </a>
    <h1 class="logo">
        <a href="/">
            
                Hoonology <span class="version"></span>
            
        </a>
    </h1>
    <a id="search" class="dosearch" role="button">
        <svg class="icon-search"><use xlink:href="#icon-search"></use></svg>
    </a>
    
</header>

<div id="mask" class="overlay"></div>

<aside class="sidebar" id="sidebar">
    <nav id="navigation">
      <h2>Menu</h2>
      <ul>
  
    
      <li>
        <a href="http://localhost:4000/">Home</a>
      </li>
    
  
    
      <li>
        <a href="http://localhost:4000/about">About</a>
      </li>
    
  
    
      <li>
        <a href="http://localhost:4000/category/blog">Github Blog</a>
      </li>
    
  
    
      <li>
        <a href="http://localhost:4000/category/yaml">YAML</a>
      </li>
    
  
    
      <li>
        <a href="http://localhost:4000/category/docker">Docker</a>
      </li>
    
  
    
  
</ul>

    </nav>
</aside>

<div class="search-wrapper">
    <div class="search-form">
        <input type="text" class="search-field" placeholder="Search">
        <svg class="icon-remove-sign"><use xlink:href="#icon-close"></use></svg>
        <ul class="search-results search-list"></ul>
    </div>
</div>



        <section class="post two-columns">
            <article role="article" class="post-content">
                <p class="post-info">
                    
                        <svg class="icon-calendar" id="date"><use xlink:href="#icon-calendar"></use></svg>
                        <time class="date" datetime="2023-05-21T09:00:00+09:00">
                            


May 21, 2023

                        </time>
                    
                    <svg id="clock" class="icon-clock"><use xlink:href="#icon-clock"></use></svg>
                    <span>8 min to read</span>
                </p>
                <h1 class="post-title">k8s 구성요소 - 볼륨과 스테이트풀셋</h1>
                <p class="post-subtitle">Kubernetes, k8s</p>

                
                    <img src="https://res.cloudinary.com/dvqcvocet/image/upload/v1684335849/%E1%84%8F%E1%85%AE%E1%84%87%E1%85%A5%E1%84%8C%E1%85%B5%E1%86%AB%E1%84%89%E1%85%B3_yoqeyy.png" alt="Featured image" class="post-cover">
                

                <!-- Pagination links -->



                <!-- Add your table of contents here -->


                <h1 id="볼륨과-스테이트풀셋">볼륨과 스테이트풀셋</h1>

<p><img src="/assets/img/kubernetes/volume.png" alt="volume" /></p>
<h2 id="파드-stateless">파드 : Stateless</h2>

<ul>
  <li>파드 : 일시적, 언제나 삭제될 수 있으므로, ‘Stateless’</li>
  <li>디플로이먼트 : 파드의 교체와 배치를 담당
    <ul>
      <li>‘레플리카셋’을 통해 파드를 scale out, 생성된 파드들은 상호 대체 가능</li>
    </ul>
  </li>
</ul>

<h2 id="파드-삭제-후-데이터-남기기">파드 삭제 후 데이터 남기기</h2>

<ul>
  <li>파드의 데이터를 남겨야할 때 사용하는 ‘Statefull’ DB 애플리케이션을 사용한다.
    <ul>
      <li>MySQL, mongoDB, edis</li>
      <li>DB를 담은 파드 삭제 시 데이터가 삭제되는 것을 방지하기 위해 ‘<strong>볼륨</strong>‘을 연결한다.</li>
    </ul>
  </li>
  <li>파드에 볼륨을 연결하면, 데이터를 영속적으로 저장하는 것이 가능하다.</li>
</ul>

<p><img src="/assets/img/kubernetes/ebs.png" alt="vol2" /></p>

<h4 id="볼륨과-퍼시스턴스-볼륨persistence-volume은-어떤-차이가-있나요-aws-ec2에도-비슷한-개념이-있습니다-ebs와-인스턴스-스토어-볼륨의-차이점과-연결해서-설명해-주세요">볼륨과 퍼시스턴스 볼륨(Persistence Volume)은 어떤 차이가 있나요? AWS EC2에도 비슷한 개념이 있습니다. EBS와 인스턴스 스토어 볼륨의 차이점과 연결해서 설명해 주세요.</h4>

<p>AWS EC2의 맥락에서 <strong>EBS</strong>(Elastic Block Store) 및 <strong>인스턴스 스토어 볼륨</strong>의 개념을 이해하는 것부터 시작하겠습니다.</p>

<p><strong>EBS 볼륨</strong>은 EC2 인스턴스에 <u>영구 블록 수준 스토리지를 제공하는 네트워크 연결 스토리지 장치</u>입니다. 이는 <strong>인스턴스의 수명 주기와 독립적</strong>입니다. 즉, <strong>EBS 볼륨에 저장된 데이터는 인스턴스가 중지되거나 종료된 후에도 지속</strong>됩니다. EBS 볼륨은 내구성과 안정성을 위해 설계되었으며 스냅샷, 암호화, 인스턴스에서 볼륨을 연결/분리하는 기능과 같은 기능을 제공합니다.</p>

<p>반면 <strong>임시 스토리</strong>지라고도 하는 <strong>인스턴스 스토어 볼륨</strong>은 EC2 인스턴스의 호스트 서버에 물리적으로 연결된 임시 블록 수준 스토리지 장치입니다. 이러한 볼륨은 지연 시간이 짧은 <strong>고성능 스토리지</strong>를 제공하지만 인스턴스가 중지되거나 종료되거나 기본 하드웨어에 장애가 발생하면 <strong>볼륨에 저장된 데이터가 손실</strong>된다는 중요한 특성이 있습니다.</p>

<p>이제 이러한 개념을 보다 일반적으로 “볼륨” 및 “지속성 볼륨”이라는 용어에 연결해 보겠습니다.
더 넓은 맥락에서 “<strong>볼륨</strong>“은 일반적으로 <strong>가상 머신이나 컨테이너와 같은 컴퓨팅 리소스에 연결할 수 있는 논리적 스토리지 단위</strong>를 나타냅니다. 데이터 저장 및 검색을 위한 파일 시스템 인터페이스를 제공합니다.</p>

<p><strong>Kubernetes에서 “영구 볼륨”(PV)은 포드 정의에서 스토리지 구성을 분리하는 스토리지 추상화</strong>입니다. 클러스터에서 스토리지 리소스를 프로비저닝하고 관리하는 방법을 제공합니다. 영구 볼륨은 클러스터의 저장소(예: 디스크, 네트워크 연결 저장소 또는 클라우드 저장소 장치)를 나타내는 Kubernetes 리소스입니다.<br />
볼륨과 영구 볼륨의 주요 차이점은 지속성 측면입니다. 일반 볼륨은 모든 저장 장치에 대한 일반적인 용어이지만 영구 볼륨은 포드 또는 컨테이너의 수명 주기 동안 지속되는 내구성 있고 지속적인 스토리지를 제공하도록 특별히 설계되었습니다.</p>

<p><img src="/assets/img/kubernetes/pv.png" alt="pv" /></p>

<p>(storage:iGi가 아닌, 1Gi _ 오타수정)</p>

<blockquote>
  <p>요약하자면, AWS EC2 컨텍스트에서 <strong>EBS 볼륨</strong>은 <u>인스턴스가 중지되거나 종료된 경우에도 유지되는 영구 스토리지를 제공</u>하는 반면, <strong>인스턴스 스토어 볼륨</strong>은 인스턴스의 수명 주기 이상으로 지속되지 않는 <u>임시 고성능 스토리지를 제공</u>합니다.</p>
</blockquote>

<p><strong>Kubernetes 컨텍스트에서 영구 볼륨(PV)</strong>은 파드에서 분리되어 컨테이너화된 애플리케이션에 영구 스토리지를 제공하는 내구성 있는 스토리지 리소스를 나타냅니다.</p>

<h2 id="stateful한-애플리케이션-관리">Stateful한 애플리케이션 관리</h2>

<p>파드 명세에 PV를 정의해서 직접 연결하는 것은 좋은 방법이 아닙니다.</p>

<blockquote>
  <p>이러한 의존도를 줄이기 위해, 퍼시스턴스 볼륨 클레임(Persistence Volume Claim, 이하 PVC)을 이용하여 PV와 연결합니다. PVC는 파드가 볼륨의 세부 사항을 몰라도 볼륨을 사용할 수 있게 도와줍니다.</p>
</blockquote>

<ul>
  <li>PV는 실제로 데이터가 저장되는 공간입니다.</li>
  <li>PVC는 PV를 선택, 연결해 주는 요청 그 자체입니다.</li>
</ul>

<h4 id="왜-파드와-pv를-직접-연결하는-것이-좋지-않은가요">왜 파드와 PV를 직접 연결하는 것이 좋지 않은가요?</h4>

<ul>
  <li>유연성 및 이식성: Pod는 일시적으로 생성, 소멸 또는 동적으로 노드 간에 이동할 수 있습니다. 포드를 PV에 직접 연결하면 견고하게 결합되어 유연성과 휴대성이 제한됩니다. 포드를 이동하거나 일정을 변경해야 하는 경우 PV를 분리했다가 다시 연결해야 하므로 작업이 중단되고 다운타임이 발생할 수 있습니다.</li>
  <li>스토리지 프로비저닝 분리: PV를 추상화 계층으로 사용하여 포드 정의에서 스토리지 프로비저닝 프로세스를 분리합니다. 이를 통해 관리자 또는 운영자는 스토리지 리소스를 독립적으로 관리하여 더 많은 제어 및 유연성을 제공할 수 있습니다. 또한 팟(Pod) 사양을 수정하지 않고도 다양한 팟(Pod)에 다양한 스토리지 클래스 및 유형을 사용할 수 있습니다.</li>
  <li>동적 프로비저닝: Kubernetes의 스토리지 클래스를 사용하여 PV를 동적으로 프로비저닝할 수 있습니다. 즉, 지정된 정책 및 요구 사항에 따라 필요에 따라 PV가 자동으로 생성될 수 있습니다. 포드를 PV에 직접 연결하면 이 동적 프로비저닝 메커니즘을 우회하여 스토리지 리소스를 효율적으로 확장하고 관리하는 기능이 제한됩니다.</li>
  <li>다중 포드 액세스: 많은 경우 여러 포드가 동일한 영구 볼륨에 동시에 액세스해야 할 수 있습니다. 포드를 PV에 직접 연결하면 액세스 및 동기화를 수동으로 관리해야 하므로 복잡하고 오류가 발생하기 쉽습니다. 영구 볼륨 클레임(PVC)의 Kubernetes 추상화를 사용하여 동일한 PV에 액세스하는 포드 간에 적절한 액세스 제어 및 조정을 보장할 수 있습니다.</li>
  <li>향후 호환성: Kubernetes는 진화하는 플랫폼이며 새로운 기능, 스토리지 옵션 및 개선 사항이 지속적으로 도입되고 있습니다. PV를 중간 계층으로 사용하면 스토리지 환경의 향후 업데이트 및 변경 사항과의 호환성을 보장할 수 있습니다. 포드가 PV에 직접 연결된 경우 Kubernetes 스토리지 하위 시스템의 변경 또는 개선을 위해 포드 구성을 크게 수정해야 할 수 있습니다.</li>
</ul>

<h2 id="stateful한-애플리케이션이-수평-확장한다면">Stateful한 애플리케이션이 수평 확장한다면</h2>

<p>파드를 정의할 때 PVC를 통해 볼륨에 연결할 수가 있습니다. 그런데, 그냥 이러한 파드를 디플로이먼트로 배포해도, <strong>PVC를 통해 연결되는 볼륨은 하나이기 때문에, 결국 같은 스토리지를 사용하는 모양새</strong>가 됩니다.</p>

<p><img src="https://s3.ap-northeast-2.amazonaws.com/urclass-images/hlEhZmhAzKDKCuc5fQC4r-1650398862538.png" alt="Alt text" /></p>

<p><strong>파드마다 별도의 데이터를 저장</strong>할 수 있게 만들려면, <strong>수평확장되는 파드에 서로 다른 PV가 연결</strong>되어야 합니다. 파드가 PV를 동적으로 요청해서 그때그때 볼륨이 생성되게 하면 어떨까요? <strong>스토리지 클래스(StorageClass)</strong> 리소스는 사용자가 요청할 때, <strong>자동으로 PV를 프로비저닝 할 수 있게 돕습니다.</strong></p>

<blockquote>
  <p>참고 : <a href="https://kubernetes.io/ko/docs/concepts/storage/dynamic-provisioning/">url</a></p>
</blockquote>

<p><img src="https://s3.ap-northeast-2.amazonaws.com/urclass-images/9mrE0wievDmSR9yeTbnF1-1650398888796.png" alt="Alt text" /></p>

<p><img src="/assets/img/kubernetes/binding.png" alt="pvc" />
<img src="/assets/img/kubernetes/binding2.png" alt="pvc2" /></p>

<h2 id="스테이트풀셋">스테이트풀셋</h2>

<p>애플리케이션 <strong>구성(파드)을 복제</strong>하더라도, <strong>스토리지 클래스</strong>를 이용해 파드가 필요로 하는 볼륨을 자동으로 프로비저닝하여 연결합니다. 따라서 첫 번째 파드를 primary(master), 두 번째 파드를 secondary 복제본처럼 구성하는 것도 가능합니다.</p>

<blockquote>
  <p>디플로이먼트와 스테이트풀셋은 둘 다 동일한 컨테이너 스펙을 기반으로 둔 파드들을 관리합니다.<br />
하지만, 스테이트풀셋은 <strong>파드의 순서와 고유성을 보장</strong>합니다.<br />
즉, 스테이트풀셋이 생성한 파드는 대체할 수 없는 파드가 된다는 의미입니다.</p>
</blockquote>

<h2 id="스테이트풀셋-주의사항">스테이트풀셋 주의사항</h2>

<ul>
  <li>파드에 지정된 스토리지는 관리자에 의해 <strong>퍼시스턴트 볼륨 프로비저너</strong>를 기반으로 하는 <strong>storage class</strong>를 요청해서 프로비전하거나 사전에 프로비전이 되어야 한다.</li>
  <li><strong>헤드리스 서비스</strong>가 필요하다.</li>
</ul>

<h4 id="q-네트워크-트래픽에-따라-요청이-랜덤하게-분산되는-일반적인-서비스에-비해-헤드리스-서비스는-특정-스테이트풀셋에게-트래픽을-보냅니다-왜-그렇게-해야-하나요">Q. 네트워크 트래픽에 따라 요청이 랜덤하게 분산되는 일반적인 서비스에 비해, 헤드리스 서비스는 특정 스테이트풀셋에게 트래픽을 보냅니다. 왜 그렇게 해야 하나요?</h4>

<ul>
  <li><strong>안정적인 네트워크 ID</strong>: Kubernetes의 <strong>StatefulSet</strong>는 <strong>안정적인 네트워크 ID와 영구 스토리지</strong>가 필요한 상태 저장 애플리케이션을 관리하도록 <strong>설계</strong>되었습니다. StatefulSet의 각 인스턴스에는 고유한 호스트 이름과 안정적인 네트워크 ID가 있습니다. <strong>헤드리스 서비스</strong>를 사용하면 안정적인 네트워크 ID로 특정 인스턴스에 <strong>직접 액세스</strong>할 수 있습니다.</li>
  <li><strong>결정적 통신</strong>: 일부 애플리케이션에는 인스턴스 간에 결정적 통신 패턴이 필요합니다. <strong>헤드리스 서비스를 사용하면 트래픽이 전달되는 방식을 제어</strong>할 수 있으므로 <strong>StatefulSet의 인스턴스 간에 특정 통신 패턴이나 프로토콜을 구현</strong>할 수 있습니다. 이는 특정 인스턴스 간의 조정이 필요한 분산 시스템, 데이터베이스 또는 응용 프로그램에 특히 유용합니다.</li>
  <li>순서가 지정된 작업: 어떤 경우에는 작업 순서 또는 순서가 응용 프로그램의 정확성에 매우 중요합니다. 헤드리스 서비스는 요청이 특정 순서로 StatefulSet의 인스턴스로 라우팅되도록 하여 조율되고 정렬된 작업 처리를 가능하게 합니다. 이는 엄격한 순서 또는 순차적 처리에 의존하는 애플리케이션에 특히 중요합니다.</li>
  <li>향상된 제어 및 모니터링: 헤드리스 서비스를 사용하면 StatefulSet 인스턴스에 대한 트래픽 흐름을 세밀하게 제어하고 볼 수 있습니다. 애플리케이션 요구 사항에 맞는 사용자 정의 로드 밸런싱, 라우팅 또는 트래픽 관리 메커니즘을 구현할 수 있습니다. 이 수준의 제어를 통해 더 나은 모니터링, 관찰 가능성 및 디버깅 기능을 사용할 수 있습니다.</li>
  <li>맞춤형 서비스 검색: 헤드리스 서비스는 일반 서비스처럼 로드 밸런싱 또는 서비스 검색을 자동으로 제공하지 않습니다. 대신 StatefulSet의 개별 인스턴스에 대한 DNS 이름을 반환합니다. 이를 통해 사용자 지정 서비스 검색 메커니즘을 구현하여 애플리케이션 요구 사항에 맞는 보다 맞춤화되고 전문화된 검색 솔루션을 사용할 수 있습니다.</li>
</ul>

<p>헤드리스 서비스가 모든 시나리오에 적합하지 않을 수 있다는 점에 유의하는 것이 중요합니다. 이들은 특정 통신 패턴, 결정론적 순서 또는 네트워크 트래픽에 대한 세분화된 제어가 필요한 상태 저장 애플리케이션 또는 분산 시스템에서 주로 사용됩니다. 상태 비저장 애플리케이션이나 로드 밸런싱 및 자동 서비스 검색이 더 중요한 경우에는 일반적으로 일반 서비스가 선호됩니다.</p>

<h4 id="q1-애플리케이션에-http-500과-같은-에러가-발생한-경우-컨테이너를-다시-실행해야-할-것입니다-http-에러가-발생했다는-것을-어떻게-알-수-있을까요-어떻게-해야-쿠버네티스가-에러가-발생한-컨테이너를-자동으로-재시작하게-만들-수-있을까요-힌트-liveness-probe-키워드를-검색하세요">Q1. 애플리케이션에 HTTP 500과 같은 에러가 발생한 경우, 컨테이너를 다시 실행해야 할 것입니다. HTTP 에러가 발생했다는 것을 어떻게 알 수 있을까요? 어떻게 해야 쿠버네티스가 에러가 발생한 컨테이너를 자동으로 재시작하게 만들 수 있을까요? (힌트: liveness probe 키워드를 검색하세요)</h4>

<p>컨테이너 내의 애플리케이션이 HTTP 500과 같은 HTTP 오류를 발생시키는지 감지하려면 Kubernetes에서 활성 프로브를 활용할 수 있습니다. 활동성 프로브는 컨테이너의 상태를 주기적으로 확인하고 제대로 작동하는지 확인하는 메커니즘입니다. 애플리케이션의 특정 엔드포인트에 요청을 보내고 HTTP 응답 코드를 검사하는 HTTP 기반 활동성 프로브를 구성할 수 있습니다.</p>

<p>500 상태 코드와 같은 HTTP 오류가 활동성 프로브에 의해 감지되면 Kubernetes는 컨테이너가 실패한 상태인 것으로 간주합니다. 기본적으로 Kubernetes는 활동성 프로브에 실패한 컨테이너를 자동으로 다시 시작합니다.</p>

<p>Kubernetes 매니페스트 파일에서 활동성 프로브를 구성하려면 다음 키워드를 사용할 수 있습니다.</p>

<p>livenessProbe: 이 필드는 활성 프로브에 대한 매개변수를 지정합니다. 프로브 유형(예: HTTP, TCP 또는 명령), 확인할 경로 또는 포트 및 기타 관련 설정을 정의할 수 있습니다.
initialDelaySeconds: 이 매개변수는 컨테이너가 시작된 후 첫 번째 활성 프로브를 수행하기 전에 Kubernetes가 대기해야 하는 시간(초)을 결정합니다.
periodSeconds: 이 매개변수는 후속 활성 프로브가 발생해야 하는 빈도를 설정합니다.
failureThreshold: 이 매개변수는 컨테이너가 실패한 것으로 간주하는 데 필요한 연속 프로브 실패 횟수를 정의합니다.</p>

<p>적절한 활성 프로브를 구성하고 다시 시작 정책을 기본값(“항상”)으로 두면 Kubernetes는 HTTP 오류가 발생하거나 활성 프로브에 실패한 컨테이너를 자동으로 다시 시작합니다. 이렇게 하면 애플리케이션이 계속 실행되고 오류 복구를 시도할 수 있습니다.</p>

<h4 id="q2-왜-파드와-pv퍼시스턴스볼륨를-직접-연결하지-않는-걸까요">Q2. 왜 파드와 PV(퍼시스턴스볼륨)를 직접 연결하지 않는 걸까요?</h4>

<p>다음과 같은 몇 가지 이유로 인해 Kubernetes의 PersistenceVolume(PV)에 포드를 직접 연결하는 것은 권장되지 않습니다.</p>

<p>유연성 및 이식성: Kubernetes의 포드는 임시로 설계되었습니다. 즉, 동적으로 생성, 이동 또는 종료될 수 있습니다. Pod를 특정 PV에 직접 연결하면 서로 긴밀하게 연결되므로 PV를 분리했다가 다시 연결하지 않고 Pod를 재배치하거나 일정을 변경하기가 어렵습니다. 이는 애플리케이션의 유연성과 이식성을 감소시킵니다.
동적 프로비저닝: Kubernetes는 PersistentVolumeClaim(PVC)에 지정된 요구 사항을 기반으로 PV를 동적으로 프로비저닝하는 기능을 제공합니다. 이를 통해 PV를 직접 지정하지 않고도 스토리지 리소스를 주문형으로 할당할 수 있습니다. 포드가 특정 PV에 직접 연결되면 동적 프로비저닝 메커니즘을 우회하여 진화하는 애플리케이션 요구 사항에 따라 추가 스토리지 용량 또는 다른 스토리지 클래스의 활용을 방지합니다.
추상화 및 관리 용이성: PVC를 중간 계층으로 활용하여 기본 스토리지 구현 세부 정보에서 포드를 분리합니다. PVC는 스토리지 요청을 나타내고 PV는 실제 스토리지 리소스를 나타냅니다. 이 추상화 계층을 통해 관리자 또는 운영자는 스토리지 리소스를 독립적으로 관리하고 할당하여 더 나은 제어, 모니터링 및 확장성을 제공할 수 있습니다.
다중 포드 액세스: 많은 경우 공유 데이터베이스 또는 분산 파일 시스템 설정과 같이 여러 포드가 동일한 PV에 동시에 액세스해야 할 수 있습니다. Pod를 PV에 직접 연결하면 수동 조정 및 동기화가 필요하므로 동시 액세스 관리가 어려워집니다. PVC 및 적절한 액세스 제어 메커니즘을 사용하여 PV에 대한 원활하고 제어된 다중 포드 액세스를 활성화할 수 있습니다.</p>

<p>PVC를 추상화 계층으로 활용하고 Pod를 PV에서 분리하면 Kubernetes에서 더 나은 유연성, 확장성 및 관리 용이성을 얻을 수 있습니다. 영구 스토리지 리소스의 동적 프로비저닝, 이식성 및 단순화된 관리를 허용하므로 Kubernetes 배포에서 권장되는 접근 방식입니다.</p>


                <!-- Pagination links -->


            </article>

            
                <aside class="see-also">
                    <h2>See also</h2>
                    <ul>
                        
                        
                        
                            <li>
                                <a href="/API-%EB%94%94%EC%9E%90%EC%9D%B8%EA%B3%BC-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4-%EA%B0%84-%ED%86%B5%EC%8B%A0/">
                                    
                                        <img src="https://res.cloudinary.com/dvqcvocet/image/upload/v1683088696/m8krc7ci1vzzbl7sxeac.png">
                                    
                                    <h3>API 디자인과 프로세스 간 통신</h3>
                                </a>
                            </li>
                        
                            <li>
                                <a href="/IaC/">
                                    
                                        <img src="https://res.cloudinary.com/dvqcvocet/image/upload/v1683864943/dev-jeans_kadf7q.png">
                                    
                                    <h3>IaC</h3>
                                </a>
                            </li>
                        
                            <li>
                                <a href="/Review/">
                                    
                                        <img src="https://res.cloudinary.com/dvqcvocet/image/upload/v1684335849/%E1%84%8F%E1%85%AE%E1%84%87%E1%85%A5%E1%84%8C%E1%85%B5%E1%86%AB%E1%84%89%E1%85%B3_yoqeyy.png">
                                    
                                    <h3>Chapter III - Review</h3>
                                </a>
                            </li>
                        
                    </ul>
                </aside>
            

        </section>

        <!-- Add time bar only for pages without pagination -->
        
            <div class="time-bar" data-minutes="8">
    <span class="time-completed"></span>
    <span class="time-remaining"></span>
    <div class="bar">
        <span class="completed" style="width:0%;"></span>
        <span class="remaining" style="width:100%;"></span>
    </div>
</div>

            <div class="recommendation">
    <div class="message">
        <strong>Why don't you read something next?</strong>
        <div>
            <button>
                <svg><use xlink:href="#icon-arrow-right"></use></svg>
                <span>Go back to top</span>
            </button>
        </div>
    </div>
    
    <a href="/k8s-ingress/" class="post-preview">
        <div class="image">
            
                <img src="https://res.cloudinary.com/dvqcvocet/image/upload/v1684335849/%E1%84%8F%E1%85%AE%E1%84%87%E1%85%A5%E1%84%8C%E1%85%B5%E1%86%AB%E1%84%89%E1%85%B3_yoqeyy.png">
            
        </div>
        <h3 class="title">k8s 네트워크 - Ingress</h3>
    </a>
</div>

        

        <!-- Show modal if the post is the last one -->
        

        <!-- Show modal before user leaves the page -->
        

        <!-- Add your newsletter subscription form here -->

        <section class="share">
    <h3>Share</h3>
    <a aria-label="Share on Twitter" href="https://twitter.com/intent/tweet?text=&quot;파드 그 자체는 Stateless, 파드의 교체와 배치를 담당하는 것이 '디플로이먼트', 레플리카셋을 통해 파드를 scale out하며, 이때 만들어지는 파드들은 상호 대체 가능합니다.&quot;%20http://localhost:4000/k8s-volume/%20via%20&#64;&hashtags=kubernetes,k8s,pod,workload,워크로드"
    onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;" title="Share on Twitter">
        <svg class="icon icon-twitter"><use xlink:href="#icon-twitter"></use></svg>
    </a>
    <a aria-label="Share on Facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/k8s-volume/"
    onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;" title="Share on Facebook">
        <svg class="icon icon-facebook"><use xlink:href="#icon-facebook"></use></svg>
    </a>
</section>

        


        

<section class="comments">
    <h3>Comments</h3>
    <div id="disqus_thread"></div>
</section>
<script type="text/javascript">
    var disqus_loaded = false;

    function load_disqus()
    {
        disqus_loaded = true;
        var disqus_shortname = 'hoonology';
        var disqus_title = '';
        var disqus_url = '/k8s-volume/';
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        var ldr = document.getElementById('disqus_loader');
    };
    window.onscroll = function(e) {
        if ((window.innerHeight + window.scrollY) >= (document.body.offsetHeight - 800)) {
            //hit bottom of page
            if (disqus_loaded==false)
                load_disqus()
        }
    };
</script>



        <footer>
    <p>
      
        <a href="https://github.com/hoonology" title="Github">
          <svg><use xlink:href="#icon-github"></use></svg>
        </a>
      
      
      
      
      
        <a href="https://www.instagram.com/ho.o_ny" title="Instagram">
          <svg><use xlink:href="#icon-instagram"></use></svg>
        </a>
      
      
    </p>

    <ul>
  
    
      <li>
        <a href="http://localhost:4000/">Home</a>
      </li>
    
  
    
      <li>
        <a href="http://localhost:4000/about">About</a>
      </li>
    
  
    
      <li>
        <a href="http://localhost:4000/category/blog">Github Blog</a>
      </li>
    
  
    
      <li>
        <a href="http://localhost:4000/category/yaml">YAML</a>
      </li>
    
  
    
      <li>
        <a href="http://localhost:4000/category/docker">Docker</a>
      </li>
    
  
    
  
</ul>


    <!-- <p>
      <span>Jekflix</span> was made with <svg class="love"><use xlink:href="#icon-heart"></use></svg> by <a href="https://rossener.com" target="_blank" class="creator">Thiago Rossener</a>
    </p> -->
</footer>









<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "name": "Hoonology",
  "description": "Hoonology changes whole world.",
  "url": "http://localhost:4000/",
  "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:4000/assets/img/icons/mediumtile.png",
      "width": "600",
      "height": "315"
  },
  "sameAs": [
    "https://github.com/hoonology","https://www.instagram.com/ho.o_ny"
  ]
}
</script>

<!-- Include the script that allows Netlify CMS login -->
<script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>

<!-- Include the website scripts -->
<script src="/assets/js/scripts.min.js"></script>

<!-- Include Google Analytics script -->
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-JJ0MLGN5R6"></script>
<script>
  var host = window.location.hostname;
  if (host != 'localhost') {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-JJ0MLGN5R6');
  }
</script>
  


<!-- Include extra scripts -->



        

        
        
        
        
        
        
        
        
        <script type="application/ld+json">
        {
            "@context": "http://schema.org",
            "@type": "BlogPosting",
            "name": "k8s 구성요소 - 볼륨과 스테이트풀셋",
            "headline": "Kubernetes, k8s",
            "description": "파드 그 자체는 Stateless, 파드의 교체와 배치를 담당하는 것이 '디플로이먼트', 레플리카셋을 통해 파드를 scale out하며, 이때 만들어지는 파드들은 상호 대체 가능합니다.",
            "image": "https://res.cloudinary.com/dvqcvocet/image/upload/v1684335849/%E1%84%8F%E1%85%AE%E1%84%87%E1%85%A5%E1%84%8C%E1%85%B5%E1%86%AB%E1%84%89%E1%85%B3_yoqeyy.png",
            "url": "http://localhost:4000/k8s-volume/",
            "articleBody": "볼륨과 스테이트풀셋


파드 : Stateless


  파드 : 일시적, 언제나 삭제될 수 있으므로, ‘Stateless’
  디플로이먼트 : 파드의 교체와 배치를 담당
    
      ‘레플리카셋’을 통해 파드를 scale out, 생성된 파드들은 상호 대체 가능
    
  


파드 삭제 후 데이터 남기기


  파드의 데이터를 남겨야할 때 사용하는 ‘Statefull’ DB 애플리케이션을 사용한다.
    
      MySQL, mongoDB, edis
      DB를 담은 파드 삭제 시 데이터가 삭제되는 것을 방지하기 위해 ‘볼륨‘을 연결한다.
    
  
  파드에 볼륨을 연결하면, 데이터를 영속적으로 저장하는 것이 가능하다.




볼륨과 퍼시스턴스 볼륨(Persistence Volume)은 어떤 차이가 있나요? AWS EC2에도 비슷한 개념이 있습니다. EBS와 인스턴스 스토어 볼륨의 차이점과 연결해서 설명해 주세요.

AWS EC2의 맥락에서 EBS(Elastic Block Store) 및 인스턴스 스토어 볼륨의 개념을 이해하는 것부터 시작하겠습니다.

EBS 볼륨은 EC2 인스턴스에 영구 블록 수준 스토리지를 제공하는 네트워크 연결 스토리지 장치입니다. 이는 인스턴스의 수명 주기와 독립적입니다. 즉, EBS 볼륨에 저장된 데이터는 인스턴스가 중지되거나 종료된 후에도 지속됩니다. EBS 볼륨은 내구성과 안정성을 위해 설계되었으며 스냅샷, 암호화, 인스턴스에서 볼륨을 연결/분리하는 기능과 같은 기능을 제공합니다.

반면 임시 스토리지라고도 하는 인스턴스 스토어 볼륨은 EC2 인스턴스의 호스트 서버에 물리적으로 연결된 임시 블록 수준 스토리지 장치입니다. 이러한 볼륨은 지연 시간이 짧은 고성능 스토리지를 제공하지만 인스턴스가 중지되거나 종료되거나 기본 하드웨어에 장애가 발생하면 볼륨에 저장된 데이터가 손실된다는 중요한 특성이 있습니다.

이제 이러한 개념을 보다 일반적으로 “볼륨” 및 “지속성 볼륨”이라는 용어에 연결해 보겠습니다.
더 넓은 맥락에서 “볼륨“은 일반적으로 가상 머신이나 컨테이너와 같은 컴퓨팅 리소스에 연결할 수 있는 논리적 스토리지 단위를 나타냅니다. 데이터 저장 및 검색을 위한 파일 시스템 인터페이스를 제공합니다.

Kubernetes에서 “영구 볼륨”(PV)은 포드 정의에서 스토리지 구성을 분리하는 스토리지 추상화입니다. 클러스터에서 스토리지 리소스를 프로비저닝하고 관리하는 방법을 제공합니다. 영구 볼륨은 클러스터의 저장소(예: 디스크, 네트워크 연결 저장소 또는 클라우드 저장소 장치)를 나타내는 Kubernetes 리소스입니다.
볼륨과 영구 볼륨의 주요 차이점은 지속성 측면입니다. 일반 볼륨은 모든 저장 장치에 대한 일반적인 용어이지만 영구 볼륨은 포드 또는 컨테이너의 수명 주기 동안 지속되는 내구성 있고 지속적인 스토리지를 제공하도록 특별히 설계되었습니다.



(storage:iGi가 아닌, 1Gi _ 오타수정)


  요약하자면, AWS EC2 컨텍스트에서 EBS 볼륨은 인스턴스가 중지되거나 종료된 경우에도 유지되는 영구 스토리지를 제공하는 반면, 인스턴스 스토어 볼륨은 인스턴스의 수명 주기 이상으로 지속되지 않는 임시 고성능 스토리지를 제공합니다.


Kubernetes 컨텍스트에서 영구 볼륨(PV)은 파드에서 분리되어 컨테이너화된 애플리케이션에 영구 스토리지를 제공하는 내구성 있는 스토리지 리소스를 나타냅니다.

Stateful한 애플리케이션 관리

파드 명세에 PV를 정의해서 직접 연결하는 것은 좋은 방법이 아닙니다.


  이러한 의존도를 줄이기 위해, 퍼시스턴스 볼륨 클레임(Persistence Volume Claim, 이하 PVC)을 이용하여 PV와 연결합니다. PVC는 파드가 볼륨의 세부 사항을 몰라도 볼륨을 사용할 수 있게 도와줍니다.



  PV는 실제로 데이터가 저장되는 공간입니다.
  PVC는 PV를 선택, 연결해 주는 요청 그 자체입니다.


왜 파드와 PV를 직접 연결하는 것이 좋지 않은가요?


  유연성 및 이식성: Pod는 일시적으로 생성, 소멸 또는 동적으로 노드 간에 이동할 수 있습니다. 포드를 PV에 직접 연결하면 견고하게 결합되어 유연성과 휴대성이 제한됩니다. 포드를 이동하거나 일정을 변경해야 하는 경우 PV를 분리했다가 다시 연결해야 하므로 작업이 중단되고 다운타임이 발생할 수 있습니다.
  스토리지 프로비저닝 분리: PV를 추상화 계층으로 사용하여 포드 정의에서 스토리지 프로비저닝 프로세스를 분리합니다. 이를 통해 관리자 또는 운영자는 스토리지 리소스를 독립적으로 관리하여 더 많은 제어 및 유연성을 제공할 수 있습니다. 또한 팟(Pod) 사양을 수정하지 않고도 다양한 팟(Pod)에 다양한 스토리지 클래스 및 유형을 사용할 수 있습니다.
  동적 프로비저닝: Kubernetes의 스토리지 클래스를 사용하여 PV를 동적으로 프로비저닝할 수 있습니다. 즉, 지정된 정책 및 요구 사항에 따라 필요에 따라 PV가 자동으로 생성될 수 있습니다. 포드를 PV에 직접 연결하면 이 동적 프로비저닝 메커니즘을 우회하여 스토리지 리소스를 효율적으로 확장하고 관리하는 기능이 제한됩니다.
  다중 포드 액세스: 많은 경우 여러 포드가 동일한 영구 볼륨에 동시에 액세스해야 할 수 있습니다. 포드를 PV에 직접 연결하면 액세스 및 동기화를 수동으로 관리해야 하므로 복잡하고 오류가 발생하기 쉽습니다. 영구 볼륨 클레임(PVC)의 Kubernetes 추상화를 사용하여 동일한 PV에 액세스하는 포드 간에 적절한 액세스 제어 및 조정을 보장할 수 있습니다.
  향후 호환성: Kubernetes는 진화하는 플랫폼이며 새로운 기능, 스토리지 옵션 및 개선 사항이 지속적으로 도입되고 있습니다. PV를 중간 계층으로 사용하면 스토리지 환경의 향후 업데이트 및 변경 사항과의 호환성을 보장할 수 있습니다. 포드가 PV에 직접 연결된 경우 Kubernetes 스토리지 하위 시스템의 변경 또는 개선을 위해 포드 구성을 크게 수정해야 할 수 있습니다.


Stateful한 애플리케이션이 수평 확장한다면

파드를 정의할 때 PVC를 통해 볼륨에 연결할 수가 있습니다. 그런데, 그냥 이러한 파드를 디플로이먼트로 배포해도, PVC를 통해 연결되는 볼륨은 하나이기 때문에, 결국 같은 스토리지를 사용하는 모양새가 됩니다.



파드마다 별도의 데이터를 저장할 수 있게 만들려면, 수평확장되는 파드에 서로 다른 PV가 연결되어야 합니다. 파드가 PV를 동적으로 요청해서 그때그때 볼륨이 생성되게 하면 어떨까요? 스토리지 클래스(StorageClass) 리소스는 사용자가 요청할 때, 자동으로 PV를 프로비저닝 할 수 있게 돕습니다.


  참고 : url







스테이트풀셋

애플리케이션 구성(파드)을 복제하더라도, 스토리지 클래스를 이용해 파드가 필요로 하는 볼륨을 자동으로 프로비저닝하여 연결합니다. 따라서 첫 번째 파드를 primary(master), 두 번째 파드를 secondary 복제본처럼 구성하는 것도 가능합니다.


  디플로이먼트와 스테이트풀셋은 둘 다 동일한 컨테이너 스펙을 기반으로 둔 파드들을 관리합니다.
하지만, 스테이트풀셋은 파드의 순서와 고유성을 보장합니다.
즉, 스테이트풀셋이 생성한 파드는 대체할 수 없는 파드가 된다는 의미입니다.


스테이트풀셋 주의사항


  파드에 지정된 스토리지는 관리자에 의해 퍼시스턴트 볼륨 프로비저너를 기반으로 하는 storage class를 요청해서 프로비전하거나 사전에 프로비전이 되어야 한다.
  헤드리스 서비스가 필요하다.


Q. 네트워크 트래픽에 따라 요청이 랜덤하게 분산되는 일반적인 서비스에 비해, 헤드리스 서비스는 특정 스테이트풀셋에게 트래픽을 보냅니다. 왜 그렇게 해야 하나요?


  안정적인 네트워크 ID: Kubernetes의 StatefulSet는 안정적인 네트워크 ID와 영구 스토리지가 필요한 상태 저장 애플리케이션을 관리하도록 설계되었습니다. StatefulSet의 각 인스턴스에는 고유한 호스트 이름과 안정적인 네트워크 ID가 있습니다. 헤드리스 서비스를 사용하면 안정적인 네트워크 ID로 특정 인스턴스에 직접 액세스할 수 있습니다.
  결정적 통신: 일부 애플리케이션에는 인스턴스 간에 결정적 통신 패턴이 필요합니다. 헤드리스 서비스를 사용하면 트래픽이 전달되는 방식을 제어할 수 있으므로 StatefulSet의 인스턴스 간에 특정 통신 패턴이나 프로토콜을 구현할 수 있습니다. 이는 특정 인스턴스 간의 조정이 필요한 분산 시스템, 데이터베이스 또는 응용 프로그램에 특히 유용합니다.
  순서가 지정된 작업: 어떤 경우에는 작업 순서 또는 순서가 응용 프로그램의 정확성에 매우 중요합니다. 헤드리스 서비스는 요청이 특정 순서로 StatefulSet의 인스턴스로 라우팅되도록 하여 조율되고 정렬된 작업 처리를 가능하게 합니다. 이는 엄격한 순서 또는 순차적 처리에 의존하는 애플리케이션에 특히 중요합니다.
  향상된 제어 및 모니터링: 헤드리스 서비스를 사용하면 StatefulSet 인스턴스에 대한 트래픽 흐름을 세밀하게 제어하고 볼 수 있습니다. 애플리케이션 요구 사항에 맞는 사용자 정의 로드 밸런싱, 라우팅 또는 트래픽 관리 메커니즘을 구현할 수 있습니다. 이 수준의 제어를 통해 더 나은 모니터링, 관찰 가능성 및 디버깅 기능을 사용할 수 있습니다.
  맞춤형 서비스 검색: 헤드리스 서비스는 일반 서비스처럼 로드 밸런싱 또는 서비스 검색을 자동으로 제공하지 않습니다. 대신 StatefulSet의 개별 인스턴스에 대한 DNS 이름을 반환합니다. 이를 통해 사용자 지정 서비스 검색 메커니즘을 구현하여 애플리케이션 요구 사항에 맞는 보다 맞춤화되고 전문화된 검색 솔루션을 사용할 수 있습니다.


헤드리스 서비스가 모든 시나리오에 적합하지 않을 수 있다는 점에 유의하는 것이 중요합니다. 이들은 특정 통신 패턴, 결정론적 순서 또는 네트워크 트래픽에 대한 세분화된 제어가 필요한 상태 저장 애플리케이션 또는 분산 시스템에서 주로 사용됩니다. 상태 비저장 애플리케이션이나 로드 밸런싱 및 자동 서비스 검색이 더 중요한 경우에는 일반적으로 일반 서비스가 선호됩니다.

Q1. 애플리케이션에 HTTP 500과 같은 에러가 발생한 경우, 컨테이너를 다시 실행해야 할 것입니다. HTTP 에러가 발생했다는 것을 어떻게 알 수 있을까요? 어떻게 해야 쿠버네티스가 에러가 발생한 컨테이너를 자동으로 재시작하게 만들 수 있을까요? (힌트: liveness probe 키워드를 검색하세요)

컨테이너 내의 애플리케이션이 HTTP 500과 같은 HTTP 오류를 발생시키는지 감지하려면 Kubernetes에서 활성 프로브를 활용할 수 있습니다. 활동성 프로브는 컨테이너의 상태를 주기적으로 확인하고 제대로 작동하는지 확인하는 메커니즘입니다. 애플리케이션의 특정 엔드포인트에 요청을 보내고 HTTP 응답 코드를 검사하는 HTTP 기반 활동성 프로브를 구성할 수 있습니다.

500 상태 코드와 같은 HTTP 오류가 활동성 프로브에 의해 감지되면 Kubernetes는 컨테이너가 실패한 상태인 것으로 간주합니다. 기본적으로 Kubernetes는 활동성 프로브에 실패한 컨테이너를 자동으로 다시 시작합니다.

Kubernetes 매니페스트 파일에서 활동성 프로브를 구성하려면 다음 키워드를 사용할 수 있습니다.

livenessProbe: 이 필드는 활성 프로브에 대한 매개변수를 지정합니다. 프로브 유형(예: HTTP, TCP 또는 명령), 확인할 경로 또는 포트 및 기타 관련 설정을 정의할 수 있습니다.
initialDelaySeconds: 이 매개변수는 컨테이너가 시작된 후 첫 번째 활성 프로브를 수행하기 전에 Kubernetes가 대기해야 하는 시간(초)을 결정합니다.
periodSeconds: 이 매개변수는 후속 활성 프로브가 발생해야 하는 빈도를 설정합니다.
failureThreshold: 이 매개변수는 컨테이너가 실패한 것으로 간주하는 데 필요한 연속 프로브 실패 횟수를 정의합니다.

적절한 활성 프로브를 구성하고 다시 시작 정책을 기본값(“항상”)으로 두면 Kubernetes는 HTTP 오류가 발생하거나 활성 프로브에 실패한 컨테이너를 자동으로 다시 시작합니다. 이렇게 하면 애플리케이션이 계속 실행되고 오류 복구를 시도할 수 있습니다.

Q2. 왜 파드와 PV(퍼시스턴스볼륨)를 직접 연결하지 않는 걸까요?

다음과 같은 몇 가지 이유로 인해 Kubernetes의 PersistenceVolume(PV)에 포드를 직접 연결하는 것은 권장되지 않습니다.

유연성 및 이식성: Kubernetes의 포드는 임시로 설계되었습니다. 즉, 동적으로 생성, 이동 또는 종료될 수 있습니다. Pod를 특정 PV에 직접 연결하면 서로 긴밀하게 연결되므로 PV를 분리했다가 다시 연결하지 않고 Pod를 재배치하거나 일정을 변경하기가 어렵습니다. 이는 애플리케이션의 유연성과 이식성을 감소시킵니다.
동적 프로비저닝: Kubernetes는 PersistentVolumeClaim(PVC)에 지정된 요구 사항을 기반으로 PV를 동적으로 프로비저닝하는 기능을 제공합니다. 이를 통해 PV를 직접 지정하지 않고도 스토리지 리소스를 주문형으로 할당할 수 있습니다. 포드가 특정 PV에 직접 연결되면 동적 프로비저닝 메커니즘을 우회하여 진화하는 애플리케이션 요구 사항에 따라 추가 스토리지 용량 또는 다른 스토리지 클래스의 활용을 방지합니다.
추상화 및 관리 용이성: PVC를 중간 계층으로 활용하여 기본 스토리지 구현 세부 정보에서 포드를 분리합니다. PVC는 스토리지 요청을 나타내고 PV는 실제 스토리지 리소스를 나타냅니다. 이 추상화 계층을 통해 관리자 또는 운영자는 스토리지 리소스를 독립적으로 관리하고 할당하여 더 나은 제어, 모니터링 및 확장성을 제공할 수 있습니다.
다중 포드 액세스: 많은 경우 공유 데이터베이스 또는 분산 파일 시스템 설정과 같이 여러 포드가 동일한 PV에 동시에 액세스해야 할 수 있습니다. Pod를 PV에 직접 연결하면 수동 조정 및 동기화가 필요하므로 동시 액세스 관리가 어려워집니다. PVC 및 적절한 액세스 제어 메커니즘을 사용하여 PV에 대한 원활하고 제어된 다중 포드 액세스를 활성화할 수 있습니다.

PVC를 추상화 계층으로 활용하고 Pod를 PV에서 분리하면 Kubernetes에서 더 나은 유연성, 확장성 및 관리 용이성을 얻을 수 있습니다. 영구 스토리지 리소스의 동적 프로비저닝, 이식성 및 단순화된 관리를 허용하므로 Kubernetes 배포에서 권장되는 접근 방식입니다.
",
            "wordcount": "1565",
            "inLanguage": "ko",
            "dateCreated": "2023-05-21/",
            "datePublished": "2023-05-21/",
            "dateModified": "2023-05-21/",
            "author": {
                "@type": "Person",
                "name": "Mr. Anderson",
                
                "image": "/assets/img/uploads/profile.png",
                
                "jobTitle": "The One",
                "url": "http://localhost:4000/authors/mranderson/",
                "sameAs": [
                    "https://github.com/github_username","https://www.facebook.com/facebook_username","https://twitter.com/twitter_username","https://medium.com/@medium_username","https://www.instagram.com/instagram_username","https://www.linkedin.com/in/linkedin_username"
                ]
            },
            "publisher": {
                "@type": "Organization",
                "name": "Hoonology",
                "url": "http://localhost:4000/",
                "logo": {
                    "@type": "ImageObject",
                    "url": "http://localhost:4000/assets/img/blog-image.png",
                    "width": "600",
                    "height": "315"
                }
            },
            "mainEntityOfPage": "True",
            "genre": "k8s",
            "articleSection": "k8s",
            "keywords": ["kubernetes","k8s","pod","workload","워크로드"]
        }
        </script>
       </body>
</html>
