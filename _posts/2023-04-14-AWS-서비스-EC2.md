---
date: 2023-04-14 01:00:00
layout: post
title: AWS 서비스 - EC2
subtitle: AWS 서비스 로드맵에 대하여
description: EC2 - 아마존 웹 서비스에서 제공하는 클라우드 컴퓨팅 서비스
image: https://res.cloudinary.com/dvqcvocet/image/upload/v1681432465/dev-jeans_%E1%84%87%E1%85%A9%E1%86%A8%E1%84%89%E1%85%A1%E1%84%87%E1%85%A9%E1%86%AB_y5n0eh.png
optimized_image: https://res.cloudinary.com/dvqcvocet/image/upload/v1681432465/dev-jeans_%E1%84%87%E1%85%A9%E1%86%A8%E1%84%89%E1%85%A1%E1%84%87%E1%85%A9%E1%86%AB_y5n0eh.png 
category: AWS
tags:
  - AWS
  - cloud
  - EC2
  - 인스턴스
  - AMI
author: Hoonology
comments: true

# AWS 서비스 로드맵
## AWS 주요 서비스 목록

---

# EC2 ( Elastic Compute Cloud )
클라우드 컴퓨팅 서비스 ( ***아마존에서 가상의 컴퓨터를 한 대 빌리는 것*** )

- 인터넷(클라우드)을 통해 서버, 스토리지, 데이터베이스 등의 컴퓨팅 서비스를 제공하는 서비스

- ***Elastic Compute Cloud***  
  - Elastic이 무엇인가 ?( = '탄련적인')   
    - PC방 후불제 처럼 사용한 것만 지불하면 되는 구조
  - 성능, 용량을 자유롭게 조절할 수 있다.

## EC2 장점
### 1. 구성하는 시간 단축
![ec2_1](/assets/img/AWS/ec2pros.png)

### 2. 다양한 OS 선택 가능
AMI를 통해서 필요한 용도에 따라 다양한 운영체제에 대한 선택이 가능  
**At Plus**, CPU와 RAM, 용량까지도 손쉽게 구성할 수 있다.  

![ec2_2](/assets/img/AWS/OSselect.png)



## 인스턴스
가상 컴퓨팅 환경(서버),  
인스턴스에서 실행하려는 애플리케이션 또는 소프트웨어에 필요한 메모리 양과 컴퓨팅 파워를 기준으로 인스턴스 유형을 선택

### 인스턴스 유형
- 인스턴스를 시작할 때 지정하는 인스턴스 유형에 따라 인스턴스에 사용되는 호스트 컴퓨터의 하드웨어가 결정
  - [인스턴스 유형 레퍼런스](https://aws.amazon.com/ko/ec2/instance-types/)



### AMI( Amazon Machine Image)
***소프트웨어 구성이 기재된 템플릿***  
클라우드에서 실행되는 서버에 대한 모든 소프트웨어 환경 설정 정보를 포함한 기본 설계도 또는 청사진
![ami](/assets/img/AWS/AMI.png)
- OS( 윈도우, 우분투 리눅스 등 ), 애플리케이션 서버와 세부 내용 포함
- 특정 런타임이 설치 되어있는 템플릿( 우분투 + node.js, 윈도우 + JVM 등 ) 
- 자신이 원하는 수만큼 인스턴스 생성 가능


## EC2 인스턴스 생성의 의미
***AMI를 토대로 세팅된 PC를 빌린다.***
![ec2](/assets/img/AWS/EC2AmiInstance.png)

## 인스턴스 라이프 사이클
다양한 상태로의 전환은 아래와 같다.
![insatance](/assets/img/AWS/instance.png)

#### [Reference](https://docs.aws.amazon.com/ko_kr/ko_kr/AWSEC2/latest/UserGuide/ec2-instance-lifecycle.html)
| 인스턴스 상태 | 설명 | 인스턴스 사용 요금 |
| --- | --- | --- |
| pending | 인스턴스는 running 상태로 될 준비를 하고 있습니다. </br> 인스턴스를 처음 시작하거나 pending 상태의 인스턴스를 다시 시작하면 stopped 상태가 됩니다. | 미청구 |
| running | 인스턴스를 실행하고 사용할 준비가 되었습니다. | 청구 |
| terminated | 인스턴스가 영구적으로 삭제되었으며 시작할 수 없습니다. | 미청구 |
| shutting-down | 인스턴스가 종료할 준비를 하고 있습니다. | 미청구 |
| stopped | 인스턴스가 종료되고 사용이 불가합니다. 언제든지 인스턴스를 다시 시작할 수 있습니다. | 미청구 |
| stopping | 인스턴스가 중지 또는 중지-최대 절전 모드로 전환할 준비를 하고 있습니다. | 중지 준비 중인 경우 미청구, </br>최대 절전 모드로 전환 준비 중인 경우 청구 | 


### 인스턴스 시작 
- 인스턴스 시작 시, ```pending``` 상태로 전환 - 사용자가 지정한 인스턴스 유형에 따라 인스턴스에 사용되는 호스트 컴퓨터의 하드웨어 결정
  - AMI를 통해 부팅
- 사용 준비 후, ```running``` 상태로 전환 - running 상태로 전환하는 **즉시** 인스턴스 실행 지속에 따른 비용 청구(매 초, 최소 1분)

### 인스턴스 중지 및 시작 ( Amazon EBS 지원 인스턴스 )
인스턴스가 상태 확인을 통과하지 못하거나 애플리케이션이 예상대로 실행되고 있지 않은 경우 또는 인스턴스의 루트 볼륨이 ```Amazon EBS``` 볼륨인 경우 인스턴스를 중지했다가 시작하여 문제를 해결해 볼 수 있다.

- 인스턴스 중지 시, ```stopping``` 상태로 전환 - ```stopped``` 상태로 전환
  - 모든 Amazon EBS 볼륨에 대한 스토리지 요금은 부과됩니다. 인스턴스가 stopped상태인 경우 인스턴스 유형을 비롯하여 인스턴스의 특정 속성을 수정할 수 있습니다.
  - 인스턴스를 중지했다가 시작하면 이전 호스트 컴퓨터의 인스턴스 스토어 볼륨에 있는 데이터가 모두 손실
  - ```stopped```에서 ```running```으로 인스턴스를 전환할 때마다 **인스턴스 실행 시간에 대해 초 단위로 요금을 청구**하며, 인스턴스를 시작할 때마다 최소 1분의 요금이 부과됩니다.

### 인스턴스 최대 절전 모드( Amazon EBS 지원 인스턴스 )
- ```stopping``` 상태로 전환되고 나서 ```stopped``` 상태로 전환
- 인스턴스 중지와 다르게 최대절전모드 인스턴스가 ```stopped``` 상태면, 해당 인스턴스에 대한 사용 요금 청구 불가
  - ```stopping``` 상태일 때 비용 청구
  - 데이터 전송에 대해 사용 요금이 부과되지는 않지만 RAM 데이터에 대한 스토리지를 포함해 모든 Amazon EBS 볼륨에 대한 스토리지 요금은 부과
- ```pending```상태로 전환, 새 호스트 컴퓨터로 이동

### 인스턴스 재부팅
Amazon EC2를 사용하여 인스턴스에서 운영 체제 재부팅 명령을 실행하는 대신 **인스턴스를 재부팅하는 것이 좋다**.
- 운영 체제 재부팅과 같다.
  - 인스턴스가 동일한 호스트 컴퓨터에 남아 있고, 퍼블릭 DNS 이름, 프라이빗 IP 주소 및 인스턴스 스토어 볼륨의 모든 데이터가 유지됩니다. 
- 인스턴스를 재부팅하면 인스턴스 청구 시간이 새로 시작되지 않으며, 최소 1분 요금 부과 없이 초 단위 결제가 계속

### 인스턴스 만료
AWS에서 인스턴스를 호스팅하는 기본 하드웨어의 복구 불가능한 장애가 검색되는 경우 인스턴스가 만료 대상으로 예약됩니다.   
예약된 만료 날짜에 도달하면 인스턴스가 에 의해 중지되거나 종료됩니다AWS 인스턴스 루트 디바이스가 Amazon EBS 볼륨인 경우 인스턴스가 중지되며  
언제든지 이 인스턴스를 다시 시작할 수 있습니다. 인스턴스 루트 디바이스가 인스턴스 스토어 볼륨인 경우 인스턴스가 종료되어 다시 사용할 수 없습니다.

### 인스턴스 종료
```shutting-down``` 또는 ```terminated```로 변경되는 즉시 해당 인스턴스에 대한 요금 부과가 중지
- 인스턴스는 종료한 후에도 잠시 동안 콘솔에 표시되며 그 이후 항목이 자동으로 삭제
- 종료한 인스턴스에 연결하거나 복구할 수 없습니다.


## 인스턴스 구입 옵션
### On-Demand
장기 약정 없이 초 단위로 컴퓨팅 용량 구입 가능  
온디맨드 인스턴스가 ```running``` 상태인 시간(초)에 대해서만 지불

### Reserved
예약 인스턴스,  
온디맨드 인스턴스 요금과 비교하여 EC2 비용을 절감하는 효과 제공(75% 맥시멈) 
#### 활용하기 좋은 환경 
- 트래픽 안정
- 성능에 대한 요구 수준이 예측 가능

### Spot
스팟 인스턴스는 예비 EC2 용량을 사용하는 인스턴스 ( 온디맨드 보다 저렴하다. )
- 미사용 EC2 인스턴스를 요청할 수 있게 해준다. ( 이로 인해 가격이 저렴해진다. )
- 애플리케이션 실행 시간을 flexible하게 조정
- 애플리케이션을 중단할 수 있는 경우에 선택
#### 사용하기 좋은 환경
- 데이터 분석 
- 배치 작업
- 백그라운드 프로세싱 및 선택적 작업

#### 사용전략
애플리케이션에 대해 보장된 컴퓨팅 리소스를 최소 수준으로 유지하기 위한 한 가지 전략은 온디맨드 인스턴스의 코어 그룹을 시작하고 기회가 생기면 스팟 인스턴스로 이를 보완하는 것입니다.

## 스토리지  - 인스턴스 루트 볼륨
인스턴스 부팅을 위한 이미지가 포함되어 있습니다.  
- Elastic Block Store 혹은 인스턴스 스토어 볼륨 중 하나이다.
- 처음 EC2 인스턴스가 론칭되면 모든 루트 디바이스는 S3로부터 론칭에 필요한 정보를 가져온다. 
  - **인스턴스 스토어 기반** : S3를 통해 백업되는 인스턴스 루트 디바이스
- EBS를 제공한 이후 이미지를 EBS 볼륨 기반으로 제공
  - **EBS 기반 인스턴스** : 인스턴스를 론칭할 때마다 루트 디바이스가 EBS 볼륨에서 론칭되고 EBS 스냅샷을 통해 생성

