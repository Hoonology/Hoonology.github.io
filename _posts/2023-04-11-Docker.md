---
date: 2023-04-11 07:15:19
layout: post
title: Docker
subtitle: 도커의 필요성 - 컨테이너 방식으로 애플리케이션을 실행한다
description: 도커의 필요성 - 실행 환경에 구애받지 않고 애플리케이션을 실행할 수 있다.
image: https://res.cloudinary.com/dvqcvocet/image/upload/v1681198236/dev-jeans_r2fkxp.png
optimized_image:  https://res.cloudinary.com/dvqcvocet/image/upload/v1681198236/dev-jeans_r2fkxp.png
category: docker
tags:  
  - Docker
  - nginx
  - postgresql
author: Hoonology
paginate: true
---


# Achievement Goals
- 컨테이너 기술이 무엇인지, Docker가 왜 필요한지 알 수 있다.
- 컨테이너와 이미지, 레지스트리가 무엇인지 이해할 수 있다.
- 대표적인 레지스트리인 Docker Hub에서 이미지를 검색하고, 사용할 수 있다.
- 한 개의 이미지를 이용해서 컨테이너를 구축할 수 있다.
- 두 개 이상의 이미지를 이용해서 컨테이너를 구축하고 서로가 어떻게 연결되는 지 알 수 있다.
- Docker CLI에서 명령어를 사용해서 이미지를 생성/수정/배포하고, 컨테이너를 생성/삭제할 수 있다.
- Dockerfile을 이용해 이미지를 생성할 수 있다.
- 애플리케이션을 컨테이너화할 수 있다.

# Docker
[도커설치](https://docs.docker.com/desktop/install/mac-install/)  

![docker](https://res.cloudinary.com/dvqcvocet/image/upload/v1681195931/2880px-Docker__28container_engine_29_logo.svg_kvn7uz.png)

***"컨테이너 방식으로 애플리케이션을 실행한다"***  
***"실행 환경에 구애받지 않고 애플리케이션을 실행할 수 있다!"***

<br>

--page-break--  


# 왜 Docker인가 ?

## 컨테이너 방식의 장점
1. [**의존성 충돌 문제를 해결**](#1-의존성-출동-문제를-해결한다)한다.
  > 의존성이 충돌할 때 : 두 애플리케이션의 일정한 버전으로 의존 관계가 있을 때 하나 이상의 애플리케이션과 버전이 다를 경우 제대로 된 실행을 보장할 수 없다.  
  이에 컨테이너 기술은 위 문제를 해결한다. 어떠한 의존성도 공유하지 않고, 각자 고유의 의존성을 포함한다.
2. [**개발과 배포 환경을 일치**시킨다.](#2-개발과-배포-환경을-일치시킨다)
3. [**수평 확장**을 쉽게 해준다.](#3-수평확장을-쉽게-해준다)
4. [각 서버에 새로운 내용을 **쉽게 배포**시킨다.](#4-각-서버에-새로운-내용을-배포하기-쉽게-만들어준다)

--page-break--  


## 1. 의존성 출동 문제를 해결한다.
### 컨테이너가 하는 일
- 한 컴퓨터 안에 여러 대의 컨테이너 존재 = 애플리케이션 실행 환경 격리
- 한 컴퓨터에 서로 다른 버전의 php 설치 조건 : 컨테이너 하나 하나가 **애플리케이션 실행**에 **높은 수준의 격리를 제공**

#### 격리를 한다고?
1. 프로세스
  - 특정 컨테이너에서 작동하는 프로세스는 그 컨테이너 안에서만 액세스 가능
2. 네트워크
  - 컨테이너 하나에 하나의 IP 주소 할당
3. 파일 시스템
  - 컨테이너 안에서 사용되는 파일 시스템은 **구획화**됨 -> 해당 컨테이너에서의 명령이나 파일 등의 액세스 제한 가능

--page-break--  

## 2. 개발과 배포 환경을 일치시킨다.
### 문제 상황
#### 개발팀의 문제
개발팀 구성원들은 버전이 서로 다른 애플리케이션을 각자의 로컬 환경에 설치하여 개발을 진행한다.  
> 런타임 환경 버전 통일, 시스템 환경 변수 구성 등의 과정이 필요하다.  
각자의 OS에서 애플리케이션 등을 설치하는 과정 또한 다르다.  
문제가 발생하면 문제 해결에 대한 시간 소모가 커지게 되는 문제도 생긴다.

#### Docker로 해결 
PostgreSQL을 설치하는 가정하에,
```bash
docker run --name postgres -e POSTGRES_PASSWORD=mysecret -d postgres
```

> 애플리케이션 구성 자체가 컨테이너화 된것이라면, YAML과 명령어 하나로 애플리케이션 실행 환경이 구성 완료된다.
```bash
docker-compose up
``` 

- OS에 상관 없이 즉시 애플리케이션 실행 환경 구성 가능
- 개발 컨테이너 위에서 모든 개발팀이 동일한 환경 하에 개발 진행 가능




#### 배포 시의 문제
이제는 배포의 패러다임이 달라졌다. 서버에 파일 하나하나를 업로드하는 방식은 마치 물자를 하나하나 배에 옮기는 이전의 방식이라고 볼 수 있다.   
서버도 이제는 컨테이너에 담긴 애플리케이션을 실행하는 방식으로 서비스를 제공한다.

![배](/assets/img/Docker/%EB%B0%B0.jpeg)
<p align = "center">[사진]배에 옮기는 기존 방식 </p>

#### EC2 서버 상에 도커를 이용해 어플리케이션 배포
![배](/assets/img/Docker/%EC%BB%A8%ED%85%8C%EC%9D%B4%EB%84%88.png)
<p align = "center">[사진]컨테이너로 옮기는 방식</p>



Amazon Web Service의 EC2 상에 도커를 설치하거나, 또는 좀 더 편리하게 도커 컨테이너를 EC2 서버에서 실행할 수 있게 하는 서비스인 ECS를 이용하여 보다 쉽게 애플리케이션을 배포할 수 있다.


--page-break--  





## 3. 수평확장을 쉽게 해준다.
***"동일한 서비스가 여러 컴퓨터에서 작동한다"***  
이 말은 ***도커의 필요성***을 나타내준다.  
(트래픽에 대한 대비로 서버 증설에 컨테이너 기술, 즉 도커가 활발하게 사용된다. )

> 컨테이너 기술의 큰 장점 = **실행 환경의 일치**  
(로드밸런서에 애플리케이션을 실행한 컨테이너를 추가만하면 되기 때문이다.)

## 4. 각 서버에 새로운 내용을 배포하기 쉽게 만들어준다.

또한, **AWS**는 **서버 생성 및 삭제를 자동**으로 해주기에 **놀라운 시너지 효과**를 누릴 수 있다.  
새로운 버전의 애플리케이션을 여러 서버 중 몇 대에만 운영하여 테스트하면서 새 버전의 문제를 미리 파악가능하다. 이로써 **사용자 전체에게 영향을 끼치지 않도록 설계**할 수 있게 된다.


--page-break--  

## Docker 핵심 키워드  
### 컨테이너
컨테이너는 앞서 설명한 대로, 애플리케이션이 의존성, 네트워크 환경, 파일 시스템에 구애받지 않고, 도커라는 기술 위에 실행될 수 있도록 만든 애플리케이션 상자입니다.

### 이미지
실행되는 모든 컨테이너는 이미지로부터 생성됩니다. 이미지는 애플리케이션 및 애플리케이션 구성을 함께 담아놓은 템플릿으로, 이를 이용해 즉시 컨테이너를 만들 수 있습니다.

이미지를 이용해 여러 개의 컨테이너를 생성할 수 있습니다. 이를 이용해 앞서 설명한 애플리케이션의 수평 확장이 가능합니다.

이미지는 기본 이미지(base image)로부터 (마치 git을 사용하는 것처럼) 변경 사항을 추가/커밋해서 또 다른 이미지를 만들 수도 있습니다.  
예를 들어 node.js로 작성된 애플리케이션을 이미지로 만들고 싶은 경우, nodejs 이미지를 기본 이미지로 삼고 내가 만든 애플리케이션을 추가해 넣고, 이미지화할 수 있습니다.

이와 관련한 아주 간단한 튜토리얼이 있습니다. Self Guided Lessons의 Node.js 웹 앱의 도커라이징 레퍼런스를 참고해보세요.

### 레지스트리
이미지는 레지스트리에 저장됩니다. 대표적인 이미지 레지스트리로는 Docker Hub, Amazon ECR이 있습니다. 도커 CLI에서 이미지를 이용해 컨테이너를 생성할 때, 호스트 컴퓨터에 이미지가 존재하지 않는다면, 기본 레지스트리로부터 다운로드 받게 됩니다.


--page-break--  
# Quiz (1/7)
## 1. 도커 컨테이너는 어떤 방식으로 애플리케이션 간의 의존성 충돌을 해결하는데 도움을 주나요?

***A. 각 애플리케이션이 고유의 의존성을 가지고 개별 컨테이너 안에서 실행됨***


B.
의존성 업그레이드에 영향을 받는 모든 애플리케이션의 업그레이드를 강제하는 방식을 사용함


C.
동일한 서버에서 유사한 애플리케이션을 그룹화하여, 의존성 관리에 대한 시간을 줄여줌

<br>
<br>
<br>
<br>

--page-break--  
# Quiz (2/7)
## 2. 도커에서 컨테이너의 역할은 무엇인가요?


A.
컨테이너는 도커를 위한 가상 머신(VM)이다.


***B.컨테이너는 도커에 의해 관리/제공되는 (도커가 호스팅하는) 애플리케이션 단위이다.***


C.
컨테이너는 도커 이미지를 포함하는 데 사용된다.


<br>
<br>
<br>
<br>

--page-break--  
# Quiz (3/7)

## 3. 다음 설명에 대해 참/거짓을 고르세요.

도커 컨테이너는 다른 컨테이너로부터 분리되어 있다.

***A. 참***  
B. 거짓

<br>
<br>
<br>
<br>

--page-break--  
# Quiz (4/7)

## 4. 도커 이미지의 목적은 무엇인가요?

A. 이미지는 레지스트리를 만드는 데 사용된다.


B. 이미지는 도커가 호스팅하는 것이다.


***C. 이미지는 도커 컨테이너를 생성하는 데 사용되는 템플릿이다.***

<br>
<br>
<br>
<br>

--page-break--  

# Quiz (5/7)

## 5. 다음 설명에 대해 참/거짓을 고르세요.

한 개의 이미지는 한 개의 컨테이너만 만들수 있다.

A. 참  
***B. 거짓***

<br>
<br>
<br>
<br>

--page-break--  
# Quiz (6/7)

## 6. 도커에서 레지스트리의 역할은 무엇인가요?

A. 도커 컨테이너를 모두 저장하는 데 사용함


B. 도커 컨테이너를 만드는 데 사용함


***C. 도커 이미지를 저장하고 배포/공유하는 데 사용함***

D. 동일한 이미지에서 생성된 도커 컨테이너를 저장하는 데 사용함

<br>
<br>
<br>
<br>

--page-break--  

# Quiz (7/7)

## 7. 컨테이너에 의해 격리되어 개별적으로 소유할 수 있는 자원은 무엇인지 모두 고르세요.

A.
CPU, 메모리와 같은 컴퓨팅 파워


***B. 프로세스***


***C. 네트워크***


***D. 파일 시스템***


E.
리눅스 커널

<br>
<br>
<br>
<br>