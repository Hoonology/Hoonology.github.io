---
date: 2023-05-03 00:48:32
layout: post
title: MSA - 마이크로서비스 
subtitle: MSA
description: 아키텍처 구성의 변화 및 마이크로 서비스 소개
image: https://res.cloudinary.com/dvqcvocet/image/upload/v1683088696/m8krc7ci1vzzbl7sxeac.png
optimized_image: https://res.cloudinary.com/dvqcvocet/image/upload/v1683088696/m8krc7ci1vzzbl7sxeac.png
category: docker
tags:  
  - 아키텍처
  - 마이크로서비스
  - 
author: Hoonology
paginate: true
---


# 아키텍처의 변화
컴퓨터 아키텍처는 시간이 지남에 따라 변화하고 발전해왔고, 이러한 변화는 컴퓨터의 능력을 향상시키고 새로운 기능을 추가하는 등 여러 가지 이유로 발생한다. 

 몇 가지 주요 아키텍처 변화는 다음과 같다.

- **폰 노이만** 아키텍처: 폰 노이만 아키텍처는 **현대 컴퓨터의 기본 아키텍처**입니다. 이 아키텍처는 CPU, 메모리, 입력 장치, 출력 장치 등의 구성 요소를 갖춘 단일 프로세서 시스템을 기반으로 합니다.


- **병렬 처리** 아키텍처: 병렬 처리 아키텍처는 **동시에 여러 작업을 수행할 수 있는 컴퓨터 아키텍처**입니다. 이 아키텍처는 대규모 데이터베이스, 컴퓨터 그래픽스, 고성능 컴퓨팅 등에서 사용됩니다.


- '**클라이언트-서버**' 아키텍처: 네트워크에서 **여러 컴퓨터가 상호작용**하는 방식을 지원합니다. 이 아키텍처는 웹 애플리케이션, 이메일, 파일 공유 등에서 사용됩니다.


- **서비스 지향** 아키텍처: 서비스 지향 아키텍처는 분산된 시스템에서 서비스 제공을 중심으로 하는 아키텍처입니다. 이 아키텍처는 **웹 서비스, 클라우드 컴퓨팅** 등에서 사용됩니다.


- **모바일** 아키텍처: 모바일 아키텍처는 모바일 디바이스에서 실행되는 소프트웨어를 지원하는 아키텍처입니다. 이 아키텍처는 모바일 앱, 스마트폰, 태블릿 등에서 사용됩니다.


- **인공지능** 아키텍처: 인공지능 아키텍처는 머신 러닝 및 딥 러닝 등의 인공지능 분야에서 사용됩니다. 이 아키텍처는 신경망, CNN(Convolutional Neural Network), RNN(Recurrent Neural Network) 등을 사용하여 데이터를 처리합니다.
 
  
# 마이크로 서비스 
![마이크로서비스](/assets/img/MicroService/Microservice_Architecture.png)

애플리케이션의 전체 기능을 제공하기 위해 함께 작동하는 작고 독립적이며 느슨하게 결합된 서비스 모음으로, **애플리케이션을 구성하는 소프트웨어 개발 아키텍처**


## 마이크로 서비스의 설계
- **독립적으로 배포 가능**
- **느슨한 결합**
- **비즈니스 역량 중심으로 구성**
- **소규모 팀의 소유**
- **유지보수에 유리하고 테스트 가능**


> 마이크로서비스 아키텍처를 통해 조직은 대규모의 복잡한 애플리케이션을 빠르고, 자주, 안정적이고 지속 가능하게 제공할 수 있습니다. 이는 오늘날 세계에서 경쟁하고 승리하기 위한 필수 요소입니다.

## 서비스로서의 컴포넌트화
> 컴포넌트: 독립적으로 대체하거나 업그레이드 가능한 소프트웨어 단위  
컴포넌트화: 시스템을 구성 요소(Component)를 나누고 이를 연결하여 구축하는 것  
컴포넌트화는 어떻게?: 소프트웨어를 여러 서비스로 분리하는 것

### 라이브러리 vs. 서비스
![biao](/assets/img/MicroService/biao2.png)


## 비즈니스 수행에 따른 구성 - 프로젝트가 아닌 '제품'


### Before : 기술적 계층에 따른 팀 분류
- UI 팀, 비즈니스 로직 팀, 데이터베이스 팀  
- 단순한 변경이 필요한 경우에도 팀 간의 협업 비용이 증가함


기본적인 회사 조직의 팀 구성 
- 프론트엔드 팀
- 백엔드 팀
- 데이터 팀


각 티어는 API로 서로 통신한다.
> 기본적으로 '클라이언트-서버' 아키텍처

풀스택 아키텍처
![Fullstack](/assets/img/MicroService/microservice.png)



### after: 비즈니스 수행 능력(업무 도메인)에 따른 팀 분류


> 도메인?
예) 쇼핑몰의 경우 회원/상품/배송이 각각의 도메인이 된다.
하나의 온전한 시스템의 단위

- 팀이 하는 일이 하나의 서비스로 나뉨 → 마이크로서비스
  - 장점: 소프트웨어 스택, 데이터베이스 선택, 프로젝트 관리 등이 팀 별로 독립적이다.
  - 이를 달성하기 위해서,
    각 팀은 서비스에 대한 책임을 가져야 한다
    각 서비스는 메시지 버스(통신 인터페이스)를 통해 통신해야 한다

<br>

따라서 **마이크로서비스로 소프트웨어를 작성**할 때에는, 소프트웨어 작성에 앞서 팀의 일하는 방식을 보다 **독립적**으로 만들어내야 한다. 혹은 마이크로서비스 아키텍처를 통해, **팀의 일하는 방식이 보다 독립적으로 만들어질 수 있다**. (Dev와 Ops가 함께 만들어가야 함)

<br>

<p align="center">"서비스(엔드포인트)는 일을 하게 하고, 통신(파이프라인)은 최대한 단순하게 한다"</p>  

- 마이크로서비스에서의 프로세스 간 통신은, " *현명한 엔드포인트와 바보 파이프라인* " 접근 방식을 따름  
    - 리눅스 파이프라인의 철학과 흡사
- 서비스와 서비스 사이는 느슨(decoupled)하게, 응집성은 높게

대표적인 방법

1. REST API (HTTP)
2. 메시지 버스를 이용한 메시지 전달

![pa](/assets/img/MicroService/pa.png)


## 분산화 거버넌스, 분산화된 데이터 관리

문제점 : 중앙 집중적인 시스템은 기술을 표준화하는 경향이 있음
해결책
- 분산화된 시스템
  - 소프트웨어 스택, 데이터베이스 선택, 프로젝트 관리 등이 팀 별로 독립적
    - 데이터에 대한 분산 책임이 따름
    - 서비스 데이터베이스 간의 일관성이 중요 → 트랜잭션 협조가 중요
- 분산화된 응용 프로그램 설계 → 도메인 주도 설계(DDD, Domain-Driven Design)





# 핵심
### 1 ) 서버리스의 의미는 무엇인가요?
서버리스 컴퓨팅은 사용자가 서버를 직접 관리하는 것이 아니라 **FaaS**(Function as a Service) 또는 **BaaS**(Backend as a Service)와 같은 클라우드 공급업체가 제공하는 서비스를 사용하여 서버 인프라를 추상화하고 자동으로 서버를 프로비저닝하고 관리합니다. 이 접근 방식은 사용자가 기본 서버를 처리할 필요가 없기 때문에 "서버리스"라고 합니다.


### 2 ) 마이크로서비스와 서버리스는 어떤 관계가 있나요?
마이크로서비스와 서버리스는 **서버리스가 마이크로서비스의 배포 옵션이라는 점**에서 관련이 있습니다. **마이크로서비스는 애플리케이션이 작고 독립적이며 느슨하게 결합된 서비스로 구성된 소프트웨어 아키텍처** 스타일입니다. **서버리스는 기본 인프라에 대한 걱정 없이 이러한 서비스를 배포하고 관리하는 방법을 제공**합니다.


### 3 ) 서버리스는 마이크로서비스의 어떠한 특징들을 반영하고 있나요?
서버리스는 확장성, 민첩성 및 복원력과 같은 마이크로서비스의 여러 특성을 반영합니다. 서버리스를 사용하면 서비스가 수요에 따라 자동으로 확장되고 신속하게 배포 및 업데이트될 수 있으며 내결함성을 갖도록 설계할 수 있습니다.


### 4 ) AWS가 제공하는 서버리스 서비스들엔 어떤 것들이 있나요?
AWS는 서버리스 컴퓨팅을 위한 AWS Lambda, 서버리스 API를 위한 Amazon API Gateway, 서버리스 데이터베이스를 위한 AWS DynamoDB를 비롯한 여러 서버리스 서비스를 제공합니다. 다른 서비스로는 서버리스 워크플로용 AWS Step Functions 및 서버리스 GraphQL API용 AWS AppSync가 있습니다.


### 5 ) 마이크로서비스는 꼭 서버리스로 구현되어야 하나요?
마이크로서비스는 반드시 서버리스로 구현될 필요는 없습니다. 기존 서버 인프라 또는 Kubernetes와 같은 컨테이너 오케스트레이션 플랫폼을 사용하여 배포할 수 있습니다. 서버리스 사용 결정은 애플리케이션 요구 사항, 개발 속도 및 비용과 같은 다양한 요인에 따라 달라집니다.


### 6 ) 서버리스의 특징 중 하나인 무상태성(Stateless)은 무엇을 의미하나요?
상태 비저장은 각 기능 실행이 독립적이고 이전 실행에 의존하지 않는다는 것을 의미하는 서버리스의 특성입니 다. 이전 실행 상태에 대해 걱정하지 않고 사용 가능한 모든 서버에서 기능을 실행할 수 있으므로 확장성과 안정성이 향상됩니다.

### 7 ) 서버리스 컴퓨팅의 장단점은 무엇인가요?
서버리스 컴퓨팅의 장점에는 운영 오버헤드 감소, 확장성 향상, 소량 워크로드에 대한 비용 절감이 포함됩니다. 그러나 애플리케이션 설계의 복잡성 증가, 공급업체 종속, 장기 실행 또는 대용량 워크로드에 대한 잠재적인 성능 문제와 같은 몇 가지 문제도 있습니다.


### [C811] 마이크로서비스와 서버리스는 어떤 관계가 있나요?
마이크로서비스와 서버리스는 최신 애플리케이션을 구축하기 위해 함께 사용할 수 있는 두 가지 아키텍처 스타일입니다. 마이크로서비스는 애플리케이션을 독립적으로 개발, 배포 및 확장할 수 있는 더 작고 독립적인 구성 요소로 나누는 방식을 말합니다. 반면에 서버리스는 인프라가 추상화되고 타사 공급자가 관리하는 애플리케이션을 구축하고 실행하는 접근 방식입니다. 서버리스 아키텍처에서 코드는 일시적이고 자동으로 확장될 수 있는 상태 비저장 이벤트 트리거 함수에서 실행됩니다. 마이크로서비스는 서버리스 기능으로 배포할 수 있으므로 개발자는 확장 및 관리를 처리하는 인프라에 의존하면서 비즈니스 논리를 구축하는 데 집중할 수 있습니다.


### [C812] 서버리스의 특징 중 하나인 무상태성(Stateless)은 무엇을 의미하나요? 
상태 비저장은 서버리스 아키텍처의 주요 특징 중 하나입니다. 즉, 서버리스 환경에서 실행되는 기능은 요청 간에 상태 정보를 저장하지 않습니다. 대신 외부 서비스나 데이터 저장소에 의존하여 필요한 상태를 관리합니다. 이렇게 하면 세션 상태 또는 기타 데이터 유지에 대해 걱정할 필요 없이 사용 가능한 모든 서버에서 기능을 실행할 수 있으므로 애플리케이션을 수평으로 확장하기가 더 쉽습니다. 또한 여러 서버에서 상태를 관리하고 동기화할 필요가 없으므로 인프라 관리가 간소화됩니다.


### [C813] 마이크로서비스를 구성할 때, 데이터베이스를 꼭 분리해야 하나요? 데이터가 한 곳에 모여있지 않고 중복되어도 괜찮은가요? 모범 사례를 알아보고, 이유를 함께 적어주세요. 
일반적으로 마이크로서비스를 구성할 때 여러 곳에 데이터를 복제하는 것을 의미하더라도 데이터베이스를 분리하는 것이 좋습니다. 이는 마이크로서비스가 독립적이고 느슨하게 결합되도록 설계되었으며 데이터베이스를 공유하면 서비스 간에 긴밀한 결합이 생성될 수 있기 때문입니다. 이로 인해 전체 애플리케이션에 영향을 주지 않고 개별 서비스를 수정하거나 교체하기 어려울 수 있습니다. 데이터베이스를 분리함으로써 각 마이크로서비스는 자체 데이터와 스키마를 관리할 수 있으므로 시간이 지남에 따라 애플리케이션을 더 쉽게 발전시키고 확장할 수 있습니다.




